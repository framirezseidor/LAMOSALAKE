create or replace view MIRRORING.VW_FCT_COM_ADH_BACKORDER_ACT 
 as
    SELECT 
        ANIO AS ANIO,
        ANIOMES AS ANIOMES,
        FECHA_BACKORDER  AS FECHA_COMERCIAL,
        MES AS MES,
        '' AS ALMACENCENTRO_ID,
        '' AS ALMACEN_ID,
        CANALDISTRIB_ID AS CANALDISTRIB_ID,
        CENTRO_ID AS CENTRO_ID,
        GRUPOVENDEDORES_ID AS GRUPOVENDEDORES_ID,
        OFICINAVENTAS_ID AS OFICINAVENTAS_ID,
        ORGVENTAS_ID AS ORGVENTAS_ID,
        SECTOR_ID AS SECTOR_ID,
        SOCIEDAD_ID AS SOCIEDAD_ID,
        UENADHESIVOS_ID AS UENADHESIVOS_ID,
        ZONAVENTAS_ID AS ZONAVENTAS_ID,
        PAIS_ID AS PAIS_ID,
        REGION_ID AS REGION_ID,
        ZONATRANSPORTE_ID AS ZONATRANSPORTE_ID,
        /*********** */
        EJECUTIVOCIS_ID ,   
        '' AS ASESORFACTURA_ID,  
        '' AS TIENDARECIBO_ID ,   
        INCOTERMS_ID ,
        ASESORPEDIDO_ID ,
        MOTIVOPEDIDO_ID ,
        CONDICIONEXP_ID ,
        '' AS TIPOPOSICION_ID ,	
        /************ */
        --ASESORPEDIDO_ID AS BOR_ASESORPEDIDO_ID,
        BLOQUEOENTREGA_ID AS BOR_BLOQUEOENTREGA_ID,
        BLOQUEOENTREGA_POS_ID AS BOR_BLOQUEOENTREGA_POS_ID,
        CLASEPEDIDO_ID AS BOR_CLASEPEDIDO_ID,
        --CONDICIONEXP_ID AS BOR_CONDICIONEXP_ID,
        --EJECUTIVOCIS_ID AS BOR_EJECUTIVOCIS_ID,
        FECHA_BACKORDER AS BOR_FECHA_BACKORDER,
        FECHA_CREACION_PEDIDO AS BOR_FECHA_CREACION_PEDIDO,
        FECHA_DOCUMENTO AS BOR_FECHA_DOCUMENTO,
        FECHA_PEDIDO_CLIENTE AS BOR_FECHA_PEDIDO_CLIENTE,
        FECHA_PREFERENTE_ENTREGA AS BOR_FECHA_PREFERENTE_ENTREGA,
        --INCOTERMS_ID AS BOR_INCOTERMS_ID,
        --MOTIVOPEDIDO_ID AS BOR_MOTIVOPEDIDO_ID,
        MOTIVORECHAZO_ID AS BOR_MOTIVORECHAZO_ID,
        PEDIDO AS BOR_PEDIDO,
        PEDIDO_POS AS BOR_PEDIDO_POS,
        RANGOANTPED_ID AS BOR_RANGOANTPED_ID,
        STATUSCREDITO_ID AS BOR_STATUSCREDITO_ID,
        STATUS_BLOQUEADO_TOTAL AS BOR_STATUS_BLOQUEADO_TOTAL,
        -- '' AS PED_ASESORPEDIDO_ID,
        '' AS PED_CLASEDOC_CONSOLIDADO,
        '' AS PED_DOCUMENTO,
        0 AS PED_DOCUMENTO_POS,
        NULL AS PED_FECHA_DOCUMENTO,
        --'' AS PED_INCOTERMS_ID,
        --'' AS PED_MOTIVOPEDIDO_ID,
        '' AS PED_TIPODOCUMENTO,
    --    '' AS PED_TIPOPOSICION_ID,
    --    '' AS VTA_ASESORFACTURA_ID,
    --    '' AS VTA_ASESORPEDIDO_ID,
        '' AS VTA_CLASEFACTURA_ASOCIADO_ID,
        '' AS VTA_CLASEFACTURA_ID,
        '' AS VTA_CLASEFACTURA_ORIGEN_ID,
    --    '' AS VTA_CONDICIONEXP_ID,
        '' AS VTA_FACTURA,
        0 AS VTA_FACTURA_POS,
        NULL AS VTA_FECHA_FACTURA,
    --    '' AS VTA_INCOTERMS_ID,
        '' AS VTA_INDICADOR_ANULACION,
    --    '' AS VTA_MOTIVOPEDIDO_ID,
        '' AS VTA_ORDENCOMPRA,
        '' AS VTA_PEDIDO,
        0 AS VTA_PEDIDO_POS,
        '' AS VTA_STATUSCONTABILIDAD,
    --    '' AS VTA_TIENDARECIBO_ID,
    --    '' AS VTA_TIPOPOSICION_ID,
        '' AS VTA_TIPO_TRANSACCION,
        CONSTRUCTORA_ID AS CONSTRUCTORA_ID,
        CONVENIO_OBRA AS CONVENIO_OBRA,
        NIO_OBRA AS NIO_OBRA,
        PLAN_OBRA AS PLAN_OBRA,
        PROMOTOR_ID AS PROMOTOR_ID,
        SEGMENTO_OBRA_ID AS SEGMENTO_OBRA_ID,
        TIPO_OBRA_ID AS TIPO_OBRA_ID,
        '' AS CHOFER,
        '' AS CLASEEXPEDICION_ID,
        '' AS CLASETRANSPORTE_ID,
        NULL AS FECHA_DESPACHOEXPREAL,
        '' AS NUM_TRANSPORTE,
        '' AS PUESTOPLANTRANSP_ID,
        '' AS RUTA_ID,
        TIPOTRANSPORTE_ID AS TIPOTRANSPORTE_ID,
        '' AS TIPOVEHICULO_ID,
        '' AS TRANSPORTISTA_ID,
        TRIM(CLIENTE_ID,'0') AS CLIENTE_ID,
        DESTINATARIO_ID AS DESTINATARIO_ID,
        '' AS DEUDOR_ID,
        SOLICITANTE_ID AS SOLICITANTE_ID,
        '' AS GRUPOARTICULOS_ID,
        MATERIALCENTRO_ID AS MATERIALCENTRO_ID,
        MATERIALVENTAS_ID AS MATERIALVENTAS_ID,
        MATERIAL_ID AS MATERIAL_ID,
        TIPOMATERIAL_ID AS TIPOMATERIAL_ID,
        UNI_EST AS UNI_EST,  -- FRL 18082025 nueva medida unificada
        '' AS UNI_UMV,  -- FRL 18082025 nueva medida unificada        
        IND_BO_CONFIRMADO_TON AS BOR_IND_BO_CONFIRMADO_TON,
        IND_BO_ENTREGA_TON AS BOR_IND_BO_ENTREGA_TON,
        IND_BO_IMPORTE_DOC AS BOR_IND_BO_IMPORTE_DOC,
        IND_BO_NO_CONFIRMADO_TON AS BOR_IND_BO_NO_CONFIRMADO_TON,
        IND_BO_TOTAL_TON AS BOR_IND_BO_TOTAL_TON,
        MON_DOC AS BOR_MON_DOC,
        --UNI_EST AS BOR_UNI_EST,-- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        0 AS PED_IND_CANT_CONFIRMADA_TON,
        0 AS PED_IND_CANT_CONFIRMADA_UMV,
        0 AS PED_IND_CANT_ENTREGADA_TON,
        0 AS PED_IND_CANT_ENTREGADA_UMV,
        0 AS PED_IND_CANT_FACTURADA_TON,
        0 AS PED_IND_CANT_FACTURADA_UMV,
        0 AS PED_IND_CANT_PEDIDO_TON,
        0 AS PED_IND_CANT_PEDIDO_UMV,
        --'' AS PED_UNI_EST, -- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        --'' AS PED_UNI_UMV,
         0 AS VTA_IND_COSTOSINTERNOS_LOC,
        0 AS VTA_IND_COSTOSINTERNOS_MXN,
        0 AS VTA_IND_COSTOSINTERNOS_USD,
        0 AS VTA_IND_PESO_BRUTO,
        0 AS VTA_IND_PESO_NETO,
        0 AS VTA_IND_VENTA_CORRECTIVAS_LOC,
        0 AS VTA_IND_VENTA_CORRECTIVAS_MXN,
        0 AS VTA_IND_VENTA_CORRECTIVAS_USD,
        0 AS VTA_IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC,
        0 AS VTA_IND_VENTA_DESCUENTOFIN_PRONTOPAGO_MXN,
        0 AS VTA_IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD,
        0 AS VTA_IND_VENTA_DESCUENTOS_LOC,
        0 AS VTA_IND_VENTA_DESCUENTOS_MXN,
        0 AS VTA_IND_VENTA_DESCUENTOS_USD,
        0 AS VTA_IND_VENTA_FLETES_LOC,
        0 AS VTA_IND_VENTA_FLETES_MXN,
        0 AS VTA_IND_VENTA_FLETES_USD,
        0 AS VTA_IND_VENTA_IMPUESTOS_LOC,
        0 AS VTA_IND_VENTA_IMPUESTOS_MXN,
        0 AS VTA_IND_VENTA_IMPUESTOS_USD,
        0 AS VTA_IND_VENTA_PCP_LOC,
        0 AS VTA_IND_VENTA_PCP_TON,
        0 AS VTA_IND_VENTA_PCP_USD,
        0 AS VTA_IND_VENTA_PRECIOCONSTRUCTORA_LOC,
        0 AS VTA_IND_VENTA_PRECIOCONSTRUCTORA_MXN,
        0 AS VTA_IND_VENTA_PRECIOCONSTRUCTORA_USD,
        0 AS VTA_IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC,
        0 AS VTA_IND_VENTA_PRECIOFACTURA_IMPUESTO_MXN,
        0 AS VTA_IND_VENTA_PRECIOFACTURA_IMPUESTO_USD,
        0 AS VTA_IND_VENTA_PRECIOFACTURA_LOC,
        0 AS VTA_IND_VENTA_PRECIOFACTURA_MXN,
        0 AS VTA_IND_VENTA_PRECIOFACTURA_USD,
        0 AS VTA_IND_VENTA_PRECIOLISTA_LOC,
        0 AS VTA_IND_VENTA_PRECIOLISTA_MXN,
        0 AS VTA_IND_VENTA_PRECIOLISTA_USD,
        0 AS VTA_IND_VENTA_PRECIONETO_LOC,
        0 AS VTA_IND_VENTA_PRECIONETO_MXN,
        0 AS VTA_IND_VENTA_PRECIONETO_USD,
        0 AS VTA_IND_VENTA_PRECIOTEORICO_LOC,
        0 AS VTA_IND_VENTA_PRECIOTEORICO_MXN,
        0 AS VTA_IND_VENTA_PRECIOTEORICO_USD,
        0 AS VTA_IND_VENTA_PROMOCIONES_LOC,
        0 AS VTA_IND_VENTA_PROMOCIONES_MXN,
        0 AS VTA_IND_VENTA_PROMOCIONES_USD,
        0 AS VTA_IND_VENTA_REAL_FLETES_IMPUESTOS_LOC,
        0 AS VTA_IND_VENTA_REAL_FLETES_IMPUESTOS_MXN,
        0 AS VTA_IND_VENTA_REAL_FLETES_IMPUESTOS_USD,
        0 AS VTA_IND_VENTA_REAL_FLETES_LOC,
        0 AS VTA_IND_VENTA_REAL_FLETES_MXN,
        0 AS VTA_IND_VENTA_REAL_FLETES_USD,
        0 AS VTA_IND_VENTA_REAL_IMPUESTO_LOC,
        0 AS VTA_IND_VENTA_REAL_IMPUESTO_MXN,
        0 AS VTA_IND_VENTA_REAL_IMPUESTO_USD,
        0 AS VTA_IND_VENTA_REAL_LOC,
        0 AS VTA_IND_VENTA_REAL_MXN,
        0 AS VTA_IND_VENTA_REAL_TON,
        0 AS VTA_IND_VENTA_REAL_UMV,
        0 AS VTA_IND_VENTA_REAL_USD,
        0 AS VTA_IND_VENTA_REBATES_LOC,
        0 AS VTA_IND_VENTA_REBATES_MXN,
        0 AS VTA_IND_VENTA_REBATES_USD,
        '' AS VTA_MON_LOC,
        '' AS VTA_MON_MXN,
        '' AS VTA_MON_USD,
        --'' AS VTA_UNI_EST, -- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        '' AS VTA_UNI_PESO,
        --'' AS VTA_UNI_UMV, -- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        FECHA_CARGA AS FECHA_CARGA,
        MANDANTE AS MANDANTE,
        'BACKORDER' AS MODELO,
        SISORIGEN_ID AS SISORIGEN_ID,
        ZONA_HORARIA AS ZONA_HORARIA
    FROM 
        CON.FCT_COM_ADH_BACKORDER_ACT
    ;

    --AGREGAMOS EL CODIGO DE LOS STREAMS EN CADA VISTA
    create or replace stream MIRRORING.STREAM_FCT_COM_ADH_BACKORDER_ACT on view MIRRORING.VW_FCT_COM_ADH_BACKORDER_ACT;

    create or replace table MIRRORING.TR_FCT_COM_ADH_BACKORDER_ACT 
    as
    select * from MIRRORING.STREAM_FCT_COM_ADH_BACKORDER_ACT;