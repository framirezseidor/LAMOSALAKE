CREATE OR REPLACE VIEW CON.VW_FCT_COM_REV_VENTAS
AS
    SELECT		
        ANIO	AS 	ANIO,
        MES	AS 	MES,
        ANIOMES	AS 	ANIOMES,
        SOCIEDAD_ID	AS 	SOCIEDAD_ID,
        ORGVENTAS_ID	AS 	ORGVENTAS_ID,
        CANALDISTRIB_ID	AS 	CANALDISTRIB_ID,
        SECTOR_ID	AS 	SECTOR_ID,
        CENTRO_ID	AS 	CENTRO_ID,
        ALMACENCENTRO_ID	AS 	ALMACENCENTRO_ID,
        ALMACEN_ID	AS 	ALMACEN_ID,
        OFICINAVENTAS_ID	AS 	OFICINAVENTAS_ID,
        ZONAVENTAS_ID	AS 	ZONAVENTAS_ID,
        GRUPOVENDEDORES_ID	AS 	GRUPOVENDEDORES_ID,
        PAIS_ID	AS 	PAIS_ID,
        REGION_ID	AS 	REGION_ID,
        ZONATRANSPORTE_ID	AS 	ZONATRANSPORTE_ID,
        FECHA_FACTURA	AS 	FECHA_FACTURA,
        CLASEFACTURA_ID	AS 	CLASEFACTURA_ID,
        CLASEFACTURA_ORIGEN_ID	AS 	CLASEFACTURA_ORIGEN_ID,
        STATUSCONTABILIDAD	AS 	STATUSCONTABILIDAD,
        CONDICIONEXP_ID	AS 	CONDICIONEXP_ID,
        INCOTERMS_ID	AS 	INCOTERMS_ID,
        ASESORFACTURA_ID	AS 	ASESORFACTURA_ID,
        MOTIVOPEDIDO_ID	AS 	MOTIVOPEDIDO_ID,
        ASESORPEDIDO_ID	AS 	ASESORPEDIDO_ID,
        CONSTRUCTORA_ID	AS 	CONSTRUCTORA_ID,
        TIPO_OBRA_ID	AS 	TIPO_OBRA_ID,
        CONVENIO_OBRA	AS 	CONVENIO_OBRA,
        PLAN_OBRA	AS 	PLAN_OBRA,
        SEGMENTO_OBRA_ID	AS 	SEGMENTO_OBRA_ID,
        PROMOTOR_ID	AS 	PROMOTOR_ID,
        NIO_OBRA	AS 	NIO_OBRA,
        CLASETRANSPORTE_ID	AS 	CLASETRANSPORTE_ID,
        TRANSPORTISTA_ID	AS 	TRANSPORTISTA_ID,
        CLIENTE_ID	AS 	CLIENTE_ID,
        SOLICITANTE_ID	AS 	SOLICITANTE_ID,
        DESTINATARIO_ID	AS 	DESTINATARIO_ID,
        DEUDOR_ID	AS 	DEUDOR_ID,
        MATERIAL_ID	AS 	MATERIAL_ID,
        MATERIALVENTAS_ID	AS 	MATERIALVENTAS_ID,
        MATERIALCENTRO_ID	AS 	MATERIALCENTRO_ID,
        LOTE	AS 	LOTE,
        LOTECENTRO_ID	AS 	LOTECENTRO_ID,
        IND_VENTA_REAL_M2	AS 	IND_VENTA_REAL_M2,
        0	AS 	IND_VENTA_PCP_M2,
        0	AS 	IND_VENTA_PCP_DIN1_M2,
        0	AS 	IND_VENTA_PCP_DIN2_M2,
        0	AS 	IND_VENTA_PCP_DIN3_M2,
        UNI_EST	AS 	UNI_EST,
        IND_VENTA_PRECIOLISTA_LOC	AS 	IND_VENTA_PRECIOLISTA_LOC,
        IND_VENTA_PRECIOTEORICO_LOC	AS 	IND_VENTA_PRECIOTEORICO_LOC,
        IND_VENTA_PRECIOFACTURA_LOC	AS 	IND_VENTA_PRECIOFACTURA_LOC,
        IND_VENTA_PRECIONETO_LOC	AS 	IND_VENTA_PRECIONETO_LOC,
        IND_VENTA_REAL_LOC	AS 	IND_VENTA_REAL_LOC,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC	AS 	IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC,
        IND_VENTA_REAL_IMPUESTO_LOC	AS 	IND_VENTA_REAL_IMPUESTO_LOC,
        IND_VENTA_PRECIOCONSTRUCTORA_LOC	AS 	IND_VENTA_PRECIOCONSTRUCTORA_LOC,
        IND_VENTA_FLETES_LOC	AS 	IND_VENTA_FLETES_LOC,
        IND_VENTA_REAL_FLETES_LOC	AS 	IND_VENTA_REAL_FLETES_LOC,
        IND_VENTA_REAL_FLETES_IMPUESTOS_LOC	AS 	IND_VENTA_REAL_FLETES_IMPUESTOS_LOC,
        IND_VENTA_DESCUENTOS_LOC	AS 	IND_VENTA_DESCUENTOS_LOC,
        IND_VENTA_PROMOCIONES_LOC	AS 	IND_VENTA_PROMOCIONES_LOC,
        IND_VENTA_REBATES_LOC	AS 	IND_VENTA_REBATES_LOC,
        IND_VENTA_CORRECTIVAS_LOC	AS 	IND_VENTA_CORRECTIVAS_LOC,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC	AS 	IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC,
        IND_VENTA_IMPUESTOS_LOC	AS 	IND_VENTA_IMPUESTOS_LOC,
        IND_COSTOSINTERNOS_LOC	AS 	IND_COSTOSINTERNOS_LOC,
        0	AS 	IND_VENTA_PCP_LOC,
        0	AS 	IND_VENTA_PCP_DIN1_LOC,
        0	AS 	IND_VENTA_PCP_DIN2_LOC,
        0	AS 	IND_VENTA_PCP_DIN3_LOC,
        MON_LOC	AS 	MON_LOC,
        IND_VENTA_PRECIOLISTA_USD	AS 	IND_VENTA_PRECIOLISTA_USD,
        IND_VENTA_PRECIOTEORICO_USD	AS 	IND_VENTA_PRECIOTEORICO_USD,
        IND_VENTA_PRECIOFACTURA_USD	AS 	IND_VENTA_PRECIOFACTURA_USD,
        IND_VENTA_PRECIONETO_USD	AS 	IND_VENTA_PRECIONETO_USD,
        IND_VENTA_REAL_USD	AS 	IND_VENTA_REAL_USD,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_USD	AS 	IND_VENTA_PRECIOFACTURA_IMPUESTO_USD,
        IND_VENTA_REAL_IMPUESTO_USD	AS 	IND_VENTA_REAL_IMPUESTO_USD,
        IND_VENTA_PRECIOCONSTRUCTORA_USD	AS 	IND_VENTA_PRECIOCONSTRUCTORA_USD,
        IND_VENTA_FLETES_USD	AS 	IND_VENTA_FLETES_USD,
        IND_VENTA_REAL_FLETES_USD	AS 	IND_VENTA_REAL_FLETES_USD,
        IND_VENTA_REAL_FLETES_IMPUESTOS_USD	AS 	IND_VENTA_REAL_FLETES_IMPUESTOS_USD,
        IND_VENTA_DESCUENTOS_USD	AS 	IND_VENTA_DESCUENTOS_USD,
        IND_VENTA_PROMOCIONES_USD	AS 	IND_VENTA_PROMOCIONES_USD,
        IND_VENTA_REBATES_USD	AS 	IND_VENTA_REBATES_USD,
        IND_VENTA_CORRECTIVAS_USD	AS 	IND_VENTA_CORRECTIVAS_USD,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD	AS 	IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD,
        IND_VENTA_IMPUESTOS_USD	AS 	IND_VENTA_IMPUESTOS_USD,
        IND_COSTOSINTERNOS_USD	AS 	IND_COSTOSINTERNOS_USD,
        0	AS 	IND_VENTA_PCP_USD,
        0	AS 	IND_VENTA_PCP_DIN1_USD,
        0	AS 	IND_VENTA_PCP_DIN2_USD,
        0	AS 	IND_VENTA_PCP_DIN3_USD,
        MON_USD	AS 	MON_USD,
        SISORIGEN_ID	AS 	SISORIGEN_ID,
        MANDANTE	AS 	MANDANTE,
        FECHA_CARGA	AS 	FECHA_CARGA,
        ZONA_HORARIA	AS 	ZONA_HORARIA,
    FROM 		
        CON.FCT_COM_REV_VENTAS_ACT		
    
    WHERE
        ORGVENTAS_ID IN (SELECT ORGVENTAS_ID FROM CON.VW_DIM_ORG_ORGANIZACIONVENTAS)
        AND CANALDISTRIB_ID IN (SELECT CANALDISTRIB_ID FROM CON.VW_DIM_ORG_CANALDISTRIBUCION)
        AND CENTRO_ID IN (SELECT CENTRO_ID FROM CON.VW_DIM_ORG_CENTRO) 
        AND  OFICINAVENTAS_ID IN (SELECT OFICINAVENTAS_ID FROM CON.VW_DIM_ORG_OFICINAVENTAS)
        AND GRUPOVENDEDORES_ID IN (SELECT GRUPOVENDEDORES_ID FROM CON.VW_DIM_ORG_GRUPOVENDEDORES) 
        AND SOLICITANTE_ID IN (SELECT SOLICITANTE_ID FROM CON.VW_DIM_CLI_SOLICITANTE) 
        AND DESTINATARIO_ID IN (SELECT DESTINATARIO_ID FROM CON.VW_DIM_CLI_DESTINATARIO)
    

    UNION ALL

    SELECT		
    ANIO	AS 	ANIO,
    MES	AS 	MES,
    ANIOMES	AS 	ANIOMES,
    SOCIEDAD_ID	AS 	SOCIEDAD_ID,
    ORGVENTAS_ID	AS 	ORGVENTAS_ID,
    CANALDISTRIB_ID	AS 	CANALDISTRIB_ID,
    SECTOR_ID	AS 	SECTOR_ID,
    ''	AS 	CENTRO_ID,
    ''	AS 	ALMACENCENTRO_ID,
    ''	AS 	ALMACEN_ID,
    ''	AS 	OFICINAVENTAS_ID,
    ''	AS 	ZONAVENTAS_ID,
    ''	AS 	GRUPOVENDEDORES_ID,
    PAIS_ID	AS 	PAIS_ID,
    REGION_ID	AS 	REGION_ID,
    ''	AS 	ZONATRANSPORTE_ID,
    CONCAT(ANIO,'-',MES,'-01')	AS 	FECHA_FACTURA,
    ''	AS 	CLASEFACTURA_ID,
    ''	AS 	CLASEFACTURA_ORIGEN_ID,
    ''	AS 	STATUSCONTABILIDAD,
    ''	AS 	CONDICIONEXP_ID,
    ''	AS 	INCOTERMS_ID,
    ASESORFACTURA_ID	AS 	ASESORFACTURA_ID,
    ''	AS 	MOTIVOPEDIDO_ID,
    ''	AS 	ASESORPEDIDO_ID,
    ''	AS 	CONSTRUCTORA_ID,
    ''	AS 	TIPO_OBRA_ID,
    ''	AS 	CONVENIO_OBRA,
    ''	AS 	PLAN_OBRA,
    ''	AS 	SEGMENTO_OBRA_ID,
    ''	AS 	PROMOTOR_ID,
    ''	AS 	NIO_OBRA,
    ''	AS 	CLASETRANSPORTE_ID,
    ''	AS 	TRANSPORTISTA_ID,
    CLIENTE_ID	AS 	CLIENTE_ID,
    SOLICITANTE_ID	AS 	SOLICITANTE_ID,
    DESTINATARIO_ID	AS 	DESTINATARIO_ID,
    ''	AS 	DEUDOR_ID,
    ''	AS 	MATERIAL_ID,
    ''	AS 	MATERIALVENTAS_ID,
    ''	AS 	MATERIALCENTRO_ID,
    ''	AS 	LOTE,
    ''	AS 	LOTECENTRO_ID,
    0	AS 	IND_VENTA_REAL_M2,
    IND_VENTA_PCP_M2	AS 	IND_VENTA_PCP_M2,
    IND_VENTA_PCP_DIN1_M2	AS 	IND_VENTA_PCP_DIN1_M2,
    IND_VENTA_PCP_DIN2_M2	AS 	IND_VENTA_PCP_DIN2_M2,
    IND_VENTA_PCP_DIN3_M2	AS 	IND_VENTA_PCP_DIN3_M2,
    ''	AS 	UNI_EST,
    0	AS 	IND_VENTA_PRECIOLISTA_LOC,
    0	AS 	IND_VENTA_PRECIOTEORICO_LOC,
    0	AS 	IND_VENTA_PRECIOFACTURA_LOC,
    0	AS 	IND_VENTA_PRECIONETO_LOC,
    0	AS 	IND_VENTA_REAL_LOC,
    0	AS 	IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC,
    0	AS 	IND_VENTA_REAL_IMPUESTO_LOC,
    0	AS 	IND_VENTA_PRECIOCONSTRUCTORA_LOC,
    0	AS 	IND_VENTA_FLETES_LOC,
    0	AS 	IND_VENTA_REAL_FLETES_LOC,
    0	AS 	IND_VENTA_REAL_FLETES_IMPUESTOS_LOC,
    0	AS 	IND_VENTA_DESCUENTOS_LOC,
    0	AS 	IND_VENTA_PROMOCIONES_LOC,
    0	AS 	IND_VENTA_REBATES_LOC,
    0	AS 	IND_VENTA_CORRECTIVAS_LOC,
    0	AS 	IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC,
    0	AS 	IND_VENTA_IMPUESTOS_LOC,
    0	AS 	IND_COSTOSINTERNOS_LOC,
    IND_VENTA_PCP_LOC	AS 	IND_VENTA_PCP_LOC,
    IND_VENTA_PCP_DIN1_LOC	AS 	IND_VENTA_PCP_DIN1_LOC,
    IND_VENTA_PCP_DIN2_LOC	AS 	IND_VENTA_PCP_DIN2_LOC,
    IND_VENTA_PCP_DIN3_LOC	AS 	IND_VENTA_PCP_DIN3_LOC,
    ''	AS 	MON_LOC,
    0	AS 	IND_VENTA_PRECIOLISTA_USD,
    0	AS 	IND_VENTA_PRECIOTEORICO_USD,
    0	AS 	IND_VENTA_PRECIOFACTURA_USD,
    0	AS 	IND_VENTA_PRECIONETO_USD,
    0	AS 	IND_VENTA_REAL_USD,
    0	AS 	IND_VENTA_PRECIOFACTURA_IMPUESTO_USD,
    0	AS 	IND_VENTA_REAL_IMPUESTO_USD,
    0	AS 	IND_VENTA_PRECIOCONSTRUCTORA_USD,
    0	AS 	IND_VENTA_FLETES_USD,
    0	AS 	IND_VENTA_REAL_FLETES_USD,
    0	AS 	IND_VENTA_REAL_FLETES_IMPUESTOS_USD,
    0	AS 	IND_VENTA_DESCUENTOS_USD,
    0	AS 	IND_VENTA_PROMOCIONES_USD,
    0	AS 	IND_VENTA_REBATES_USD,
    0	AS 	IND_VENTA_CORRECTIVAS_USD,
    0	AS 	IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD,
    0	AS 	IND_VENTA_IMPUESTOS_USD,
    0	AS 	IND_COSTOSINTERNOS_USD,
    IND_VENTA_PCP_USD	AS 	IND_VENTA_PCP_USD,
    IND_VENTA_PCP_DIN1_USD	AS 	IND_VENTA_PCP_DIN1_USD,
    IND_VENTA_PCP_DIN2_USD	AS 	IND_VENTA_PCP_DIN2_USD,
    IND_VENTA_PCP_DIN3_USD	AS 	IND_VENTA_PCP_DIN3_USD,
    ''	AS 	MON_USD,
    SISORIGEN_ID	AS 	SISORIGEN_ID,
    MANDANTE	AS 	MANDANTE,
    FECHA_CARGA	AS 	FECHA_CARGA,
    ZONA_HORARIA	AS 	ZONA_HORARIA,
    FROM 		
    CON.FCT_COM_REV_VENTAS_PCP
    
    WHERE
        ORGVENTAS_ID IN (SELECT ORGVENTAS_ID FROM CON.VW_DIM_ORG_ORGANIZACIONVENTAS) AND
        CANALDISTRIB_ID IN (SELECT CANALDISTRIB_ID FROM CON.VW_DIM_ORG_CANALDISTRIBUCION) AND 
        CENTRO_ID IN (SELECT CENTRO_ID FROM CON.VW_DIM_ORG_CENTRO) AND
        SOLICITANTE_ID IN (SELECT SOLICITANTE_ID FROM CON.VW_DIM_CLI_SOLICITANTE) AND 
        DESTINATARIO_ID IN (SELECT DESTINATARIO_ID FROM CON.VW_DIM_CLI_DESTINATARIO)    
    
;		
