create or replace view CON.VW_FCT_COM_ADH_VENTAS
 as
    SELECT
        ANIO,
        MES,
        ANIOMES,
        SOCIEDAD_ID,
        ORGVENTAS_ID,
        CANALDISTRIB_ID,
        SECTOR_ID,
        CENTRO_ID,
        ALMACENCENTRO_ID,
        ALMACEN_ID,
        OFICINAVENTAS_ID,
        ZONAVENTAS_ID,
        GRUPOVENDEDORES_ID,
        UENADHESIVOS_ID,
        PAIS_ID,
        REGION_ID,
        ZONATRANSPORTE_ID,
        TIPO_TRANSACCION,
        FACTURA,
        FACTURA_POS,
        FECHA_FACTURA,
        CLASEFACTURA_ID,
        CLASEFACTURA_ORIGEN_ID,
        CLASEFACTURA_ASOCIADO_ID,
        INDICADOR_ANULACION,
        STATUSCONTABILIDAD,
        CONDICIONEXP_ID,
        INCOTERMS_ID,
        ASESORFACTURA_ID,
        TIPOPOSICION_ID,
        PEDIDO,
        PEDIDO_POS,
        ORDENCOMPRA,
        MOTIVOPEDIDO_ID,
        ASESORPEDIDO_ID,
        TIENDARECIBO_ID,
        CONSTRUCTORA_ID,
        TIPO_OBRA_ID,
        CONVENIO_OBRA,
        PLAN_OBRA,
        SEGMENTO_OBRA_ID,
        PROMOTOR_ID,
        NIO_OBRA,
        NUM_TRANSPORTE,
        CLASETRANSPORTE_ID,
        TIPOTRANSPORTE_ID,
        CLASEEXPEDICION_ID,
        PUESTOPLANTRANSP_ID,
        TRANSPORTISTA_ID,
        RUTA_ID,
        TIPOVEHICULO_ID,
        CHOFER,
        FECHA_DESPACHOEXPREAL,
        CLIENTE_ID,
        SOLICITANTE_ID,
        DESTINATARIO_ID,
        DEUDOR_ID,
        MATERIAL_ID,
        MATERIALVENTAS_ID,
        MATERIALCENTRO_ID,
        GRUPOARTICULOS_ID,
        TIPOMATERIAL_ID,
        IND_VENTA_REAL_TON,
        UNI_EST,
        IND_VENTA_REAL_UMV,
        UNI_UMV,
        IND_VENTA_PRECIOLISTA_LOC,
        IND_VENTA_PRECIOTEORICO_LOC,
        IND_VENTA_PRECIOFACTURA_LOC,
        IND_VENTA_PRECIONETO_LOC,
        IND_VENTA_REAL_LOC,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC,
        IND_VENTA_REAL_IMPUESTO_LOC,
        IND_VENTA_PRECIOCONSTRUCTORA_LOC,
        IND_VENTA_FLETES_LOC,
        IND_VENTA_REAL_FLETES_LOC,
        IND_VENTA_REAL_FLETES_IMPUESTOS_LOC,
        IND_VENTA_DESCUENTOS_LOC,
        IND_VENTA_PROMOCIONES_LOC,
        IND_VENTA_REBATES_LOC,
        IND_VENTA_CORRECTIVAS_LOC,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC,
        IND_VENTA_IMPUESTOS_LOC,
        IND_COSTOSINTERNOS_LOC,
        MON_LOC,
        IND_VENTA_PRECIOLISTA_USD,
        IND_VENTA_PRECIOTEORICO_USD,
        IND_VENTA_PRECIOFACTURA_USD,
        IND_VENTA_PRECIONETO_USD,
        IND_VENTA_REAL_USD,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_USD,
        IND_VENTA_REAL_IMPUESTO_USD,
        IND_VENTA_PRECIOCONSTRUCTORA_USD,
        IND_VENTA_FLETES_USD,
        IND_VENTA_REAL_FLETES_USD,
        IND_VENTA_REAL_FLETES_IMPUESTOS_USD,
        IND_VENTA_DESCUENTOS_USD,
        IND_VENTA_PROMOCIONES_USD,
        IND_VENTA_REBATES_USD,
        IND_VENTA_CORRECTIVAS_USD,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD,
        IND_VENTA_IMPUESTOS_USD,
        IND_COSTOSINTERNOS_USD,
        MON_USD,
        IND_VENTA_PRECIOLISTA_MXN,
        IND_VENTA_PRECIOTEORICO_MXN,
        IND_VENTA_PRECIOFACTURA_MXN,
        IND_VENTA_PRECIONETO_MXN,
        IND_VENTA_REAL_MXN,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_MXN,
        IND_VENTA_REAL_IMPUESTO_MXN,
        IND_VENTA_PRECIOCONSTRUCTORA_MXN,
        IND_VENTA_FLETES_MXN,
        IND_VENTA_REAL_FLETES_MXN,
        IND_VENTA_REAL_FLETES_IMPUESTOS_MXN,
        IND_VENTA_DESCUENTOS_MXN,
        IND_VENTA_PROMOCIONES_MXN,
        IND_VENTA_REBATES_MXN,
        IND_VENTA_CORRECTIVAS_MXN,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_MXN,
        IND_VENTA_IMPUESTOS_MXN,
        IND_COSTOSINTERNOS_MXN,
        MON_MXN,
        IND_PESO_BRUTO,
        IND_PESO_NETO,
        UNI_PESO,
        0 AS IND_VENTA_PCP_TON,
        0 AS IND_VENTA_PCP_LOC,
        0 AS IND_VENTA_PCP_USD,
        SISORIGEN_ID,
        MANDANTE,
        FECHA_CARGA,
        ZONA_HORARIA,
        FROM
        CON.FCT_COM_ADH_VENTAS_ACT
    WHERE
        ORGVENTAS_ID IN (SELECT ORGVENTAS_ID FROM CON.VW_DIM_ORG_ORGANIZACIONVENTAS)
        AND UENADHESIVOS_ID IN (SELECT UENADHESIVOS_ID FROM CON.VW_DIM_ORG_UENADHESIVOS)
        AND CANALDISTRIB_ID IN (SELECT CANALDISTRIB_ID FROM CON.VW_DIM_ORG_CANALDISTRIBUCION)
        AND CENTRO_ID IN (SELECT CENTRO_ID FROM CON.VW_DIM_ORG_CENTRO) 
        AND OFICINAVENTAS_ID IN (SELECT OFICINAVENTAS_ID FROM CON.VW_DIM_ORG_OFICINAVENTAS)
        AND GRUPOVENDEDORES_ID IN (SELECT GRUPOVENDEDORES_ID FROM CON.VW_DIM_ORG_GRUPOVENDEDORES) 
        AND (ASESORFACTURA_ID IN (SELECT ASESORCOMERCIAL_ID  FROM CON.VW_DIM_CLI_ASESORCOMERCIAL) 
            OR ASESORPEDIDO_ID IN (SELECT ASESORCOMERCIAL_ID  FROM CON.VW_DIM_CLI_ASESORCOMERCIAL)   )  
        AND SOLICITANTE_ID IN (SELECT SOLICITANTE_ID FROM CON.VW_DIM_CLI_SOLICITANTE) 
        AND DESTINATARIO_ID IN (SELECT DESTINATARIO_ID FROM CON.VW_DIM_CLI_DESTINATARIO) 
    

    UNION ALL

    SELECT
        ANIO,
        MES,
        ANIOMES,
        SOCIEDAD_ID,
        ORGVENTAS_ID,
        CANALDISTRIB_ID,
        SECTOR_ID,
        CENTRO_ID,
        '' AS ALMACENCENTRO_ID,
        '' AS ALMACEN_ID,
        OFICINAVENTAS_ID,
        '' AS ZONAVENTAS_ID,
        '' AS GRUPOVENDEDORES_ID,
        UENADHESIVOS_ID,
        PAIS_ID,
        REGION_ID,
        '' AS ZONATRANSPORTE_ID,
        '' AS TIPO_TRANSACCION,
        '' AS FACTURA,
        '' AS FACTURA_POS,
        '' AS FECHA_FACTURA,
        '' AS CLASEFACTURA_ID,
        '' AS CLASEFACTURA_ORIGEN_ID,
        '' AS CLASEFACTURA_ASOCIADO_ID,
        0 AS INDICADOR_ANULACION,
        '' AS STATUSCONTABILIDAD,
        '' AS CONDICIONEXP_ID,
        '' AS INCOTERMS_ID,
        ASESORFACTURA_ID,
        '' AS TIPOPOSICION_ID,
        '' AS PEDIDO,
        '' AS PEDIDO_POS,
        '' AS ORDENCOMPRA,
        '' AS MOTIVOPEDIDO_ID,
        '' AS ASESORPEDIDO_ID,
        '' AS TIENDARECIBO_ID,
        '' AS CONSTRUCTORA_ID,
        '' AS TIPO_OBRA_ID,
        '' AS CONVENIO_OBRA,
        '' AS PLAN_OBRA,
        '' AS SEGMENTO_OBRA_ID,
        '' AS PROMOTOR_ID,
        '' AS NIO_OBRA,
        '' AS NUM_TRANSPORTE,
        '' AS CLASETRANSPORTE_ID,
        '' AS TIPOTRANSPORTE_ID,
        '' AS CLASEEXPEDICION_ID,
        '' AS PUESTOPLANTRANSP_ID,
        '' AS TRANSPORTISTA_ID,
        '' AS RUTA_ID,
        '' AS TIPOVEHICULO_ID,
        '' AS CHOFER,
        '' AS FECHA_DESPACHOEXPREAL,
        CLIENTE_ID,
        SOLICITANTE_ID,
        DESTINATARIO_ID,
        '' AS DEUDOR_ID,
        MATERIAL_ID,
        MATERIALVENTAS_ID,
        MATERIALCENTRO_ID,
        '' AS GRUPOARTICULOS_ID,
        '' AS TIPOMATERIAL_ID,
        0 AS IND_VENTA_REAL_TON,
        UNI_EST,
        0 AS IND_VENTA_REAL_UMV,
        '' AS UNI_UMV,
        0 AS IND_VENTA_PRECIOLISTA_LOC,
        0 AS IND_VENTA_PRECIOTEORICO_LOC,
        0 AS IND_VENTA_PRECIOFACTURA_LOC,
        0 AS IND_VENTA_PRECIONETO_LOC,
        0 AS IND_VENTA_REAL_LOC,
        0 AS IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC,
        0 AS IND_VENTA_REAL_IMPUESTO_LOC,
        0 AS IND_VENTA_PRECIOCONSTRUCTORA_LOC,
        0 AS IND_VENTA_FLETES_LOC,
        0 AS IND_VENTA_REAL_FLETES_LOC,
        0 AS IND_VENTA_REAL_FLETES_IMPUESTOS_LOC,
        0 AS IND_VENTA_DESCUENTOS_LOC,
        0 AS IND_VENTA_PROMOCIONES_LOC,
        0 AS IND_VENTA_REBATES_LOC,
        0 AS IND_VENTA_CORRECTIVAS_LOC,
        0 AS IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC,
        0 AS IND_VENTA_IMPUESTOS_LOC,
        0 AS IND_COSTOSINTERNOS_LOC,
        MON_LOC,
        0 AS IND_VENTA_PRECIOLISTA_USD,
        0 AS IND_VENTA_PRECIOTEORICO_USD,
        0 AS IND_VENTA_PRECIOFACTURA_USD,
        0 AS IND_VENTA_PRECIONETO_USD,
        0 AS IND_VENTA_REAL_USD,
        0 AS IND_VENTA_PRECIOFACTURA_IMPUESTO_USD,
        0 AS IND_VENTA_REAL_IMPUESTO_USD,
        0 AS IND_VENTA_PRECIOCONSTRUCTORA_USD,
        0 AS IND_VENTA_FLETES_USD,
        0 AS IND_VENTA_REAL_FLETES_USD,
        0 AS IND_VENTA_REAL_FLETES_IMPUESTOS_USD,
        0 AS IND_VENTA_DESCUENTOS_USD,
        0 AS IND_VENTA_PROMOCIONES_USD,
        0 AS IND_VENTA_REBATES_USD,
        0 AS IND_VENTA_CORRECTIVAS_USD,
        0 AS IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD,
        0 AS IND_VENTA_IMPUESTOS_USD,
        0 AS IND_COSTOSINTERNOS_USD,
        MON_USD,
        0 AS IND_VENTA_PRECIOLISTA_MXN,
        0 AS IND_VENTA_PRECIOTEORICO_MXN,
        0 AS IND_VENTA_PRECIOFACTURA_MXN,
        0 AS IND_VENTA_PRECIONETO_MXN,
        0 AS IND_VENTA_REAL_MXN,
        0 AS IND_VENTA_PRECIOFACTURA_IMPUESTO_MXN,
        0 AS IND_VENTA_REAL_IMPUESTO_MXN,
        0 AS IND_VENTA_PRECIOCONSTRUCTORA_MXN,
        0 AS IND_VENTA_FLETES_MXN,
        0 AS IND_VENTA_REAL_FLETES_MXN,
        0 AS IND_VENTA_REAL_FLETES_IMPUESTOS_MXN,
        0 AS IND_VENTA_DESCUENTOS_MXN,
        0 AS IND_VENTA_PROMOCIONES_MXN,
        0 AS IND_VENTA_REBATES_MXN,
        0 AS IND_VENTA_CORRECTIVAS_MXN,
        0 AS IND_VENTA_DESCUENTOFIN_PRONTOPAGO_MXN,
        0 AS IND_VENTA_IMPUESTOS_MXN,
        0 AS IND_COSTOSINTERNOS_MXN,
        '' AS MON_MXN,
        0 AS IND_PESO_BRUTO,
        0 AS IND_PESO_NETO,
        '' AS UNI_PESO,
        IND_VENTA_PCP_TON,
        IND_VENTA_PCP_LOC,
        IND_VENTA_PCP_USD,        
        SISORIGEN_ID,
        MANDANTE,
        FECHA_CARGA,
        ZONA_HORARIA
    FROM 
        CON.FCT_COM_ADH_VENTAS_PCP
    WHERE
        ORGVENTAS_ID IN (SELECT ORGVENTAS_ID FROM CON.VW_DIM_ORG_ORGANIZACIONVENTAS) AND
        CANALDISTRIB_ID IN (SELECT CANALDISTRIB_ID FROM CON.VW_DIM_ORG_CANALDISTRIBUCION) AND 
        CENTRO_ID IN (SELECT CENTRO_ID FROM CON.VW_DIM_ORG_CENTRO) AND
        ASESORFACTURA_ID IN (SELECT ASESORCOMERCIAL_ID FROM CON.VW_DIM_CLI_ASESORCOMERCIAL) AND 
        SOLICITANTE_ID IN (SELECT SOLICITANTE_ID FROM CON.VW_DIM_CLI_SOLICITANTE) AND 
        DESTINATARIO_ID IN (SELECT DESTINATARIO_ID FROM CON.VW_DIM_CLI_DESTINATARIO)    
 
;