
create or alter view CON.VW_DIM_ORG_GRUPOVENDEDORES
WITH ROW ACCESS POLICY SEGURIDAD.RAP_SAP_DIM_GRUPOVENDEDORES_ID ON (GRUPOVENDEDORES_ID)
as
WITH PASO1 AS (
    SELECT
        GRUPOVENDEDORES_ID,
        GRUPOVENDEDORES_TEXT,
        SISORIGEN_ID,
        MANDANTE,
        FECHA_CARGA,
        ZONA_HORARIA
    FROM CON.DIM_ORG_GRUPOVENDEDORES
), PASO2 AS (
    SELECT
        NULL GRUPOVENDEDORES_ID,
        'SIN ASIGNAR' GRUPOVENDEDORES_TEXT,
        '--' SISORIGEN_ID,
        '--' MANDANTE,
        CURRENT_TIMESTAMP() FECHA_CARGA,
        '--' ZONA_HORARIA
), PASO3 AS (
    SELECT
        '' GRUPOVENDEDORES_ID,
        'SIN ASIGNAR' GRUPOVENDEDORES_TEXT,
        '--' SISORIGEN_ID,
        '--' MANDANTE,
        CURRENT_TIMESTAMP() FECHA_CARGA,
        '--' ZONA_HORARIA
), FINAL AS (
    SELECT * FROM PASO1
    UNION ALL 
    SELECT * FROM PASO2
    UNION ALL     
    SELECT * FROM PASO3
)

SELECT * FROM FINAL