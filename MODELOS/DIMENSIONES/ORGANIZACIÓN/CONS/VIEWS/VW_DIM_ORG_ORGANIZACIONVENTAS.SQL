CREATE OR alter VIEW  CON.VW_DIM_ORG_ORGANIZACIONVENTAS 
WITH ROW ACCESS POLICY SEGURIDAD.RAP_SAP_DIM_ORGVENTAS_ID ON (ORGVENTAS_ID)
AS

WITH PASO1 AS (
SELECT
O.ORGVENTAS_ID,
O.ORGVENTAS_TEXT,
O.SOCIEDAD_ID,
S.SOCIEDAD_TEXT,
O.PAIS_ID,
P.PAIS_TEXT,
O.NEGOCIOGRUPO_ID,
N.NEGOCIOGRUPO_TEXT,
O.SISORIGEN_ID,
O.MANDANTE,
O.FECHA_CARGA,
O.ZONA_HORARIA

FROM CON.DIM_ORG_ORGANIZACIONVENTAS O
LEFT JOIN CON.DIM_ORG_SOCIEDAD S ON O.SOCIEDAD_ID=S.SOCIEDAD_ID 
LEFT JOIN CON.DIM_GEO_PAIS P ON O.PAIS_ID=P.PAIS_ID 
LEFT JOIN CON.DIM_ORG_NEGOCIOGRUPO N ON O.NEGOCIOGRUPO_ID=N.NEGOCIOGRUPO_ID 
), PASO2 AS (
SELECT
    '' ORGVENTAS_ID,
    'SIN ASIGNAR 2' ORGVENTAS_TEXT,
    '--' SOCIEDAD_ID,
    '--' SOCIEDAD_TEXT,
    '--' PAIS_ID,
    '--' PAIS_TEXT,
    '--' NEGOCIOGRUPO_ID,
    '--' NEGOCIOGRUPO_TEXT,
    '--' SISORIGEN_ID,
    '--' MANDANTE,
    CURRENT_TIMESTAMP() FECHA_CARGA,
    '--' ZONA_HORARIA

), FINAL AS (
    SELECT * FROM PASO1
    UNION ALL
    SELECT * FROM PASO2

)

SELECT * FROM FINAL