create or replace view MIRRORING.VW_FCT_COM_ADH_VENTAS_HIST as  
    SELECT 
        ANIO AS ANIO,
        ANIOMES AS ANIOMES,
        FECHA_FACTURA  AS FECHA_COMERCIAL,
        MES AS MES,
        ALMACENCENTRO_ID AS ALMACENCENTRO_ID,
        ALMACEN_ID AS ALMACEN_ID,
        CANALDISTRIB_ID AS CANALDISTRIB_ID,
        CENTRO_ID AS CENTRO_ID,
        GRUPOVENDEDORES_ID AS GRUPOVENDEDORES_ID,
        OFICINAVENTAS_ID AS OFICINAVENTAS_ID,
        ORGVENTAS_ID AS ORGVENTAS_ID,
        SECTOR_ID AS SECTOR_ID,
        SOCIEDAD_ID AS SOCIEDAD_ID,
        UENADHESIVOS_ID AS UENADHESIVOS_ID,
        ZONAVENTAS_ID AS ZONAVENTAS_ID,
        PAIS_ID AS PAIS_ID,
        REGION_ID AS REGION_ID,
        ZONATRANSPORTE_ID AS ZONATRANSPORTE_ID,
        /*********** */
        '' AS EJECUTIVOCIS_ID ,   
        ASESORFACTURA_ID,  
        TIENDARECIBO_ID ,   
        INCOTERMS_ID ,
        ASESORPEDIDO_ID ,
        MOTIVOPEDIDO_ID ,
        CONDICIONEXP_ID ,
        TIPOPOSICION_ID ,	
        /************ */               
        --'' AS BOR_ASESORPEDIDO_ID,
        '' AS BOR_BLOQUEOENTREGA_ID,
        '' AS BOR_BLOQUEOENTREGA_POS_ID,
        '' AS BOR_CLASEPEDIDO_ID,
        --'' AS BOR_CONDICIONEXP_ID,
        --'' AS BOR_EJECUTIVOCIS_ID,
        NULL AS BOR_FECHA_BACKORDER,
        NULL AS BOR_FECHA_CREACION_PEDIDO,
        NULL AS BOR_FECHA_DOCUMENTO,
        NULL AS BOR_FECHA_PEDIDO_CLIENTE,
        NULL AS BOR_FECHA_PREFERENTE_ENTREGA,
        --'' AS BOR_INCOTERMS_ID,
        --'' AS BOR_MOTIVOPEDIDO_ID,
        '' AS BOR_MOTIVORECHAZO_ID,
        '' AS BOR_PEDIDO,
        0 AS BOR_PEDIDO_POS,
        '' AS BOR_RANGOANTPED_ID,
        '' AS BOR_STATUSCREDITO_ID,
        '' AS BOR_STATUS_BLOQUEADO_TOTAL,
        --'' AS PED_ASESORPEDIDO_ID,
        '' AS PED_CLASEDOC_CONSOLIDADO,
        '' AS PED_DOCUMENTO,
        0 AS PED_DOCUMENTO_POS,
        NULL AS PED_FECHA_DOCUMENTO,
        --'' AS PED_INCOTERMS_ID,
        --'' AS PED_MOTIVOPEDIDO_ID,
        '' AS PED_TIPODOCUMENTO,
        --'' AS PED_TIPOPOSICION_ID,
        --ASESORFACTURA_ID AS VTA_ASESORFACTURA_ID,
        --ASESORPEDIDO_ID AS VTA_ASESORPEDIDO_ID,
        CLASEFACTURA_ASOCIADO_ID AS VTA_CLASEFACTURA_ASOCIADO_ID,
        CLASEFACTURA_ID AS VTA_CLASEFACTURA_ID,
        CLASEFACTURA_ORIGEN_ID AS VTA_CLASEFACTURA_ORIGEN_ID,
        --CONDICIONEXP_ID AS VTA_CONDICIONEXP_ID,
        FACTURA AS VTA_FACTURA,
        FACTURA_POS AS VTA_FACTURA_POS,
        FECHA_FACTURA AS VTA_FECHA_FACTURA,
        --INCOTERMS_ID AS VTA_INCOTERMS_ID,
        INDICADOR_ANULACION AS VTA_INDICADOR_ANULACION,
        --MOTIVOPEDIDO_ID AS VTA_MOTIVOPEDIDO_ID,
        ORDENCOMPRA AS VTA_ORDENCOMPRA,
        PEDIDO AS VTA_PEDIDO,
        PEDIDO_POS AS VTA_PEDIDO_POS,
        STATUSCONTABILIDAD AS VTA_STATUSCONTABILIDAD,
        --TIENDARECIBO_ID AS VTA_TIENDARECIBO_ID,
        --TIPOPOSICION_ID AS VTA_TIPOPOSICION_ID,
        GRUPO_TRANSACCION AS VTA_GRUPO_TRANSACCION,        
        TIPO_TRANSACCION AS VTA_TIPO_TRANSACCION,
        CONSTRUCTORA_ID AS CONSTRUCTORA_ID,
        CONVENIO_OBRA AS CONVENIO_OBRA,
        NIO_OBRA AS NIO_OBRA,
        PLAN_OBRA AS PLAN_OBRA,
        PROMOTOR_ID AS PROMOTOR_ID,
        SEGMENTO_OBRA_ID AS SEGMENTO_OBRA_ID,
        TIPO_OBRA_ID AS TIPO_OBRA_ID,
        CHOFER AS CHOFER,
        CLASEEXPEDICION_ID AS CLASEEXPEDICION_ID,
        CLASETRANSPORTE_ID AS CLASETRANSPORTE_ID,
        FECHA_DESPACHOEXPREAL AS FECHA_DESPACHOEXPREAL,
        NUM_TRANSPORTE AS NUM_TRANSPORTE,
        PUESTOPLANTRANSP_ID AS PUESTOPLANTRANSP_ID,
        RUTA_ID AS RUTA_ID,
        TIPOTRANSPORTE_ID AS TIPOTRANSPORTE_ID,
        TIPOVEHICULO_ID AS TIPOVEHICULO_ID,
        TRANSPORTISTA_ID AS TRANSPORTISTA_ID,
        CLIENTE_ID AS CLIENTE_ID,
        DESTINATARIO_ID AS DESTINATARIO_ID,
        DEUDOR_ID AS DEUDOR_ID,
        SOLICITANTE_ID AS SOLICITANTE_ID,
        GRUPOARTICULOS_ID AS GRUPOARTICULOS_ID,
        MATERIALCENTRO_ID AS MATERIALCENTRO_ID,
        MATERIALVENTAS_ID AS MATERIALVENTAS_ID,
        MATERIAL_ID AS MATERIAL_ID,
        TIPOMATERIAL_ID AS TIPOMATERIAL_ID,
        UNI_EST AS UNI_EST,
        UNI_UMV AS UNI_UMV,    
        0 AS BOR_IND_BO_CONFIRMADO_TON,
        0 AS BOR_IND_BO_ENTREGA_TON,
        0 AS BOR_IND_BO_IMPORTE_DOC,
        0 AS BOR_IND_BO_NO_CONFIRMADO_TON,
        0 AS BOR_IND_BO_TOTAL_TON,
        '' AS BOR_MON_DOC,
        --'' AS BOR_UNI_EST,-- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        0 AS PED_IND_CANT_CONFIRMADA_TON,
        0 AS PED_IND_CANT_CONFIRMADA_UMV,
        0 AS PED_IND_CANT_ENTREGADA_TON,
        0 AS PED_IND_CANT_ENTREGADA_UMV,
        0 AS PED_IND_CANT_FACTURADA_TON,
        0 AS PED_IND_CANT_FACTURADA_UMV,
        0 AS PED_IND_CANT_PEDIDO_TON,
        0 AS PED_IND_CANT_PEDIDO_UMV,
        --'' AS PED_UNI_EST,-- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        --'' AS PED_UNI_UMV,-- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        IND_COSTOSINTERNOS_LOC AS VTA_IND_COSTOSINTERNOS_LOC,
        IND_COSTOSINTERNOS_MXN AS VTA_IND_COSTOSINTERNOS_MXN,
        IND_COSTOSINTERNOS_USD AS VTA_IND_COSTOSINTERNOS_USD,
        IND_PESO_BRUTO AS VTA_IND_PESO_BRUTO,
        IND_PESO_NETO AS VTA_IND_PESO_NETO,
        IND_VENTA_CORRECTIVAS_LOC AS VTA_IND_VENTA_CORRECTIVAS_LOC,
        IND_VENTA_CORRECTIVAS_MXN AS VTA_IND_VENTA_CORRECTIVAS_MXN,
        IND_VENTA_CORRECTIVAS_USD AS VTA_IND_VENTA_CORRECTIVAS_USD,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC AS VTA_IND_VENTA_DESCUENTOFIN_PRONTOPAGO_LOC,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_MXN AS VTA_IND_VENTA_DESCUENTOFIN_PRONTOPAGO_MXN,
        IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD AS VTA_IND_VENTA_DESCUENTOFIN_PRONTOPAGO_USD,
        IND_VENTA_DESCUENTOS_LOC AS VTA_IND_VENTA_DESCUENTOS_LOC,
        IND_VENTA_DESCUENTOS_MXN AS VTA_IND_VENTA_DESCUENTOS_MXN,
        IND_VENTA_DESCUENTOS_USD AS VTA_IND_VENTA_DESCUENTOS_USD,
        IND_VENTA_FLETES_LOC AS VTA_IND_VENTA_FLETES_LOC,
        IND_VENTA_FLETES_MXN AS VTA_IND_VENTA_FLETES_MXN,
        IND_VENTA_FLETES_USD AS VTA_IND_VENTA_FLETES_USD,
        IND_VENTA_IMPUESTOS_LOC AS VTA_IND_VENTA_IMPUESTOS_LOC,
        IND_VENTA_IMPUESTOS_MXN AS VTA_IND_VENTA_IMPUESTOS_MXN,
        IND_VENTA_IMPUESTOS_USD AS VTA_IND_VENTA_IMPUESTOS_USD,
        0 AS VTA_IND_VENTA_PCP_LOC,
        0 AS VTA_IND_VENTA_PCP_TON,
        0 AS VTA_IND_VENTA_PCP_USD,
        IND_VENTA_PRECIOCONSTRUCTORA_LOC AS VTA_IND_VENTA_PRECIOCONSTRUCTORA_LOC,
        IND_VENTA_PRECIOCONSTRUCTORA_MXN AS VTA_IND_VENTA_PRECIOCONSTRUCTORA_MXN,
        IND_VENTA_PRECIOCONSTRUCTORA_USD AS VTA_IND_VENTA_PRECIOCONSTRUCTORA_USD,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC AS VTA_IND_VENTA_PRECIOFACTURA_IMPUESTO_LOC,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_MXN AS VTA_IND_VENTA_PRECIOFACTURA_IMPUESTO_MXN,
        IND_VENTA_PRECIOFACTURA_IMPUESTO_USD AS VTA_IND_VENTA_PRECIOFACTURA_IMPUESTO_USD,
        IND_VENTA_PRECIOFACTURA_LOC AS VTA_IND_VENTA_PRECIOFACTURA_LOC,
        IND_VENTA_PRECIOFACTURA_MXN AS VTA_IND_VENTA_PRECIOFACTURA_MXN,
        IND_VENTA_PRECIOFACTURA_USD AS VTA_IND_VENTA_PRECIOFACTURA_USD,
        IND_VENTA_PRECIOLISTA_LOC AS VTA_IND_VENTA_PRECIOLISTA_LOC,
        IND_VENTA_PRECIOLISTA_MXN AS VTA_IND_VENTA_PRECIOLISTA_MXN,
        IND_VENTA_PRECIOLISTA_USD AS VTA_IND_VENTA_PRECIOLISTA_USD,
        IND_VENTA_PRECIONETO_LOC AS VTA_IND_VENTA_PRECIONETO_LOC,
        IND_VENTA_PRECIONETO_MXN AS VTA_IND_VENTA_PRECIONETO_MXN,
        IND_VENTA_PRECIONETO_USD AS VTA_IND_VENTA_PRECIONETO_USD,
        IND_VENTA_PRECIOTEORICO_LOC AS VTA_IND_VENTA_PRECIOTEORICO_LOC,
        IND_VENTA_PRECIOTEORICO_MXN AS VTA_IND_VENTA_PRECIOTEORICO_MXN,
        IND_VENTA_PRECIOTEORICO_USD AS VTA_IND_VENTA_PRECIOTEORICO_USD,
        IND_VENTA_PROMOCIONES_LOC AS VTA_IND_VENTA_PROMOCIONES_LOC,
        IND_VENTA_PROMOCIONES_MXN AS VTA_IND_VENTA_PROMOCIONES_MXN,
        IND_VENTA_PROMOCIONES_USD AS VTA_IND_VENTA_PROMOCIONES_USD,
        IND_VENTA_REAL_FLETES_IMPUESTOS_LOC AS VTA_IND_VENTA_REAL_FLETES_IMPUESTOS_LOC,
        IND_VENTA_REAL_FLETES_IMPUESTOS_MXN AS VTA_IND_VENTA_REAL_FLETES_IMPUESTOS_MXN,
        IND_VENTA_REAL_FLETES_IMPUESTOS_USD AS VTA_IND_VENTA_REAL_FLETES_IMPUESTOS_USD,
        IND_VENTA_REAL_FLETES_LOC AS VTA_IND_VENTA_REAL_FLETES_LOC,
        IND_VENTA_REAL_FLETES_MXN AS VTA_IND_VENTA_REAL_FLETES_MXN,
        IND_VENTA_REAL_FLETES_USD AS VTA_IND_VENTA_REAL_FLETES_USD,
        IND_VENTA_REAL_IMPUESTO_LOC AS VTA_IND_VENTA_REAL_IMPUESTO_LOC,
        IND_VENTA_REAL_IMPUESTO_MXN AS VTA_IND_VENTA_REAL_IMPUESTO_MXN,
        IND_VENTA_REAL_IMPUESTO_USD AS VTA_IND_VENTA_REAL_IMPUESTO_USD,
        IND_VENTA_REAL_LOC AS VTA_IND_VENTA_REAL_LOC,
        IND_VENTA_REAL_MXN AS VTA_IND_VENTA_REAL_MXN,
        IND_VENTA_REAL_TON AS VTA_IND_VENTA_REAL_TON,
        IND_VENTA_REAL_UMV AS VTA_IND_VENTA_REAL_UMV,
        IND_VENTA_REAL_USD AS VTA_IND_VENTA_REAL_USD,
        IND_VENTA_REBATES_LOC AS VTA_IND_VENTA_REBATES_LOC,
        IND_VENTA_REBATES_MXN AS VTA_IND_VENTA_REBATES_MXN,
        IND_VENTA_REBATES_USD AS VTA_IND_VENTA_REBATES_USD,
        MON_LOC AS VTA_MON_LOC,
        MON_MXN AS VTA_MON_MXN,
        MON_USD AS VTA_MON_USD,
        --UNI_EST AS VTA_UNI_EST,-- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        UNI_PESO AS VTA_UNI_PESO,
        --UNI_UMV AS VTA_UNI_UMV,-- FRL 18082025 se eliminan y se unifican las medidas de VENTAS, PEDIDOS y BO
        FECHA_CARGA AS FECHA_CARGA,
        MANDANTE AS MANDANTE,
        'VENTAS' AS MODELO,
        SISORIGEN_ID AS SISORIGEN_ID,
        ZONA_HORARIA AS ZONA_HORARIA
    FROM
        CON.FCT_COM_ADH_VENTAS_HIST
    ;


    create or replace stream MIRRORING.STREAM_FCT_COM_ADH_VENTAS_HIST on view MIRRORING.VW_FCT_COM_ADH_VENTAS_HIST;

    create or replace table MIRRORING.TR_FCT_COM_ADH_VENTAS_HIST 
    as
    select * from MIRRORING.STREAM_FCT_COM_ADH_VENTAS_HIST;