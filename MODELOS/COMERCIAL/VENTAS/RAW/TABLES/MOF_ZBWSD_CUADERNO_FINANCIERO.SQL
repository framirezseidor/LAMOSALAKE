CREATE OR ALTER TABLE RAW.SQ1_MOF_ZBWSD_CUADERNO_FINANCIERO (
	TS_SEQUENCE_NUMBER NUMBER(20,0),
	VKORG VARCHAR(4),
	VTWEG VARCHAR(2),
	SPART VARCHAR(2),
	VKBUR VARCHAR(4),
	FKDAT DATE,
	FKART VARCHAR(4),
	VBELN_VF VARCHAR(10),
	FKSTO VARCHAR(1),
	RFBSK VARCHAR(1),
	KUNAG VARCHAR(10),
	KUNNR_WE VARCHAR(10),
	POSNR_VF VARCHAR(6),
	PSTYV VARCHAR(4),
	FKTYP VARCHAR(20),
	VBTYP VARCHAR(20),
	AUGRU_TEXT VARCHAR(40),
	FKART_ASOCIADO VARCHAR(4),
	SFAKN VARCHAR(10),
	BZIRK VARCHAR(6),
	KUNNR_ZV VARCHAR(10),
	WERKS VARCHAR(4),
	LGORT VARCHAR(4),
	CHARG VARCHAR(10),
	CENTRO_LOTE VARCHAR(10),
	COUNTRY VARCHAR(3),
	REGION VARCHAR(10),
	TRANSPZONE VARCHAR(10),
	INCO1 VARCHAR(3),
	MTART VARCHAR(4),
	MATNR VARCHAR(40),
	NTGEW NUMBER(19,3),
	BRGEW NUMBER(19,3),
	GEWEI VARCHAR(3),
	MATKL VARCHAR(9),
	FKIMG NUMBER(17,3),
	VRKME VARCHAR(3),
	FACT_CONV VARCHAR(34),
	CANT_UN_EST NUMBER(17,3),
	MSEHI VARCHAR(3),
	IMPORTE_VTA NUMBER(22,4),
	DESCUENTO_COMERC NUMBER(22,4),
	PROMOCIONES NUMBER(22,4),
	IMPORTE_FACTURA NUMBER(22,4),
	RAPPELES NUMBER(22,4),
	ACCIONES_CORRECT NUMBER(22,4),
	VALOR_NETO NUMBER(22,4),
	WAERK VARCHAR(5),
	KURRF NUMBER(15,5),
	MONEDA_BASE VARCHAR(5),
	KURRF_USD NUMBER(15,5),
	KURRF_MXN NUMBER(15,5),
	WAVWR NUMBER(22,4),
	MWSBP NUMBER(22,4),
	AUBEL VARCHAR(10),
	AUPOS VARCHAR(6),
	SUBMI VARCHAR(10),
	ID_CONVENIO VARCHAR(10),
	ZONA_PREC VARCHAR(2),
	PRECIO NUMBER(22,4),
	CNSTR_ID VARCHAR(10),
	CNSTR_NOM VARCHAR(60),
	VKGRP VARCHAR(3),
	KUNN2 VARCHAR(10),
	ID_TIPO_TRANS VARCHAR(4),
	ID_CONSTR VARCHAR(10),
	TIENDA_SOLIC VARCHAR(10),
	FLETES NUMBER(22,4),
	TIENDA_REC VARCHAR(10),
	ASESOR_COM VARCHAR(10),
	PAGADOR VARCHAR(10),
	VSBED VARCHAR(2),
	MOTIVO_PEDIDO VARCHAR(3),
	TDLNR VARCHAR(10),
	ZUONR VARCHAR(18),
	SHTYP VARCHAR(4),
	TPLST VARCHAR(4),
	EXTI1 VARCHAR(20),
	ROUTE VARCHAR(6),
	ADD01 VARCHAR(10),
	TKNUM VARCHAR(10),
	VSART VARCHAR(2),
	DTABF DATE,
	KUNNR_ZP VARCHAR(10),
	SEGMENTO VARCHAR(40),
	SISORIGEN_ID VARCHAR(20),
	MANDANTE VARCHAR(20),
	FECHA_CARGA VARCHAR(20),
	ZONA_HORARIA VARCHAR(20)
);

-- üîé Busca en TODAS las columnas VARCHAR si contienen: Correctivas / Facturaci√≥n / Rappeles
-- Normaliza acentos y may√∫sculas para comparar.
-- Busca en TODAS las columnas VARCHAR si contienen:
-- 'Correctivas', 'Facturaci√≥n', 'Rappeles' (insensible a may√∫sculas y acentos)
-- Escanea TODAS las columnas VARCHAR de RAW.SQ1_MOF_ZBWSD_CUADERNO_FINANCIERO
-- y devuelve en qu√© columna(s) aparecen 'Correctivas' / 'Facturaci√≥n' / 'Rappeles'
-- (insensible a may√∫sculas y acentos)
-- Ajusta este USE si hace falta:
-- USE DATABASE TU_DB;

-- (Opcional) aseg√∫rate de estar en el DB correcto:
-- USE DATABASE TU_DB;
/*
SELECT 'AUGRU_TEXT' AS column_name, AUGRU_TEXT AS match_value, COUNT(*) AS cnt
FROM RAW.SQ1_MOF_ZBWSD_CUADERNO_FINANCIERO
WHERE REGEXP_LIKE(UPPER(TRANSLATE(AUGRU_TEXT,'√Å√â√ç√ì√ö√ú√ë√°√©√≠√≥√∫√º√±','AEIOUUNAEIOUUN')),
                  '^(CORRECTIVAS|FACTURACION|RAPPELES)$')
GROUP BY AUGRU_TEXT
UNION ALL
SELECT 'FKTYP', FKTYP, COUNT(*)
FROM RAW.SQ1_MOF_ZBWSD_CUADERNO_FINANCIERO
WHERE REGEXP_LIKE(UPPER(TRANSLATE(FKTYP,'√Å√â√ç√ì√ö√ú√ë√°√©√≠√≥√∫√º√±','AEIOUUNAEIOUUN')),
                  '^(CORRECTIVAS|FACTURACION|RAPPELES)$')
GROUP BY FKTYP
UNION ALL
SELECT 'ID_TIPO_TRANS', ID_TIPO_TRANS, COUNT(*)
FROM RAW.SQ1_MOF_ZBWSD_CUADERNO_FINANCIERO
WHERE REGEXP_LIKE(UPPER(TRANSLATE(ID_TIPO_TRANS,'√Å√â√ç√ì√ö√ú√ë√°√©√≠√≥√∫√º√±','AEIOUUNAEIOUUN')),
                  '^(CORRECTIVAS|FACTURACION|RAPPELES)$')
GROUP BY ID_TIPO_TRANS
UNION ALL
SELECT 'FKART', FKART, COUNT(*)
FROM RAW.SQ1_MOF_ZBWSD_CUADERNO_FINANCIERO
WHERE REGEXP_LIKE(UPPER(TRANSLATE(FKART,'√Å√â√ç√ì√ö√ú√ë√°√©√≠√≥√∫√º√±','AEIOUUNAEIOUUN')),
                  '^(CORRECTIVAS|FACTURACION|RAPPELES)$')
GROUP BY FKART;


select distinct fktyp, count(*) from raw.sq1_mof_zbwsd_cuaderno_financiero
group by fktyp;
*/
