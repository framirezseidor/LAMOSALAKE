create or REPLACE view MIRRORING.VW_FCT_FIN_ADH_RENTABILIDAD
as

SELECT 
        FECHA_CONTABILIZACION,
        ANIO_MES,
        EJERCICIO,
        PERIODO,
        CASE WHEN   PERIODO = '001' THEN'Ene'
             WHEN PERIODO = '002' THEN  'Feb'
             WHEN PERIODO = '003' THEN  'Mar'
             WHEN PERIODO = '004' THEN 'Abr'
             WHEN PERIODO = '005' THEN 'May'
             WHEN PERIODO = '006' THEN 'Jun'
             WHEN PERIODO = '007' THEN 'Jul'
             WHEN PERIODO = '008' THEN 'Ago'
             WHEN PERIODO = '009' THEN 'Sep'
             WHEN PERIODO = '010' THEN 'Oct'
             WHEN PERIODO = '011' THEN 'Nov'
             WHEN PERIODO = '012' THEN 'Dic' END AS PERIODO_NOMBRE,
        FECHA_DOCUMENTO,
        SOCIEDADCO_ID,
        SOCIEDAD_ID,
        ORGVENTAS_ID,
        CANALDISTRIB_ID,
        SECTOR_ID,
        CENTRO_ID,
        OFICINAVENTAS_ID,
        CENTROBENEFICIO_ID,
        CENTROCOSTO_ID,
        CUENTA_ID,
        CLIENTE_ID,
        SOLICITANTE_ID,
        DESTINATARIO_ID,
        GRUPOSOLICITANTE_ID,
        CONSTRUCTORA_ID,
        TIPO_OBRA_ID,
        ID_PLAN_DE_OBRA,
        PAIS_ID,
        PAISCLIENTE_ID,
        REGION_ID,
        ZONATRANSPORTE_ID,
        MATERIAL_ID,
        CLAVE_MONEDA,
        UNIDAD_MEDIDA,
        CENTROCOSTO_GRUPO_ID,
        CUENTA_GRUPO_ID,
        CONVENIO_OBRA,
        CENTRO_VENTA, 
        CENTRO_FABRICACION,
        IND_HSL,
        IND_QUANT2,
        IND_FAB_COSTOVENTAFIJO,
        IND_VTA_IMP_PRECIOLISTA_ML,
        IND_VTA_IMP_DESCUENTOS_ML,
        IND_VTA_IMP_PROMOCIONES_ML,
        IND_VTA_IMP_RAPPELES_ML,
        IND_VTA_IMP_CORRECTIVAS_ML,
        IND_VTA_IMP_VENTAREAL_ML,
        IND_VTA_IMP_VENTAREAL_TON,
        IND_VTA_PRECIO_CONSTRUCTORA_ML,
        IND_VTA_IMP_CONSTRUCTORA_ML,
        IND_FAB_MOD,
        IND_FAB_MOI,
        IND_FAB_ELECTRICIDAD,
        IND_FAB_DEPRECIACION,
        IND_FAB_MANTENIMIENTO,
        IND_FAB_GASTOSINDIRECTOS,
        IND_FAB_EMPAQUE,
        IND_FAB_CEMENTOS,
        IND_FAB_QUIMICOSMP,
        IND_FAB_CARGASQUIMICAS,
        IND_FAB_PTCOMPRADO,
        IND_FAB_CARBONATOCOMPRADO,
        IND_FAB_CARBONATOPIEDRA,
        IND_FAB_SUBCONTRATACIONMAQUILA,
        IND_FAB_OTROCOSTOSVENTA,
        IND_FAB_VARIOSADH,
        0 as IND_FAB_PTMAQUILA,
        IND_FAB_MOD_FIL,
        IND_FAB_MOI_FIL,
        IND_FAB_ELECTRICIDAD_FIL,
        IND_FAB_DEPRECIACION_FIL,
        IND_FAB_MANTENIMIENTO_FIL,
        IND_FAB_GASTOSINDIRECTOS_FIL,
        IND_FAB_EMPAQUE_FIL,
        IND_FAB_CEMENTOS_FIL,
        IND_FAB_QUIMICOSMP_FIL,
        IND_FAB_CARGASQUIMICAS_FIL,
        IND_FAB_CARBONATOCOMPRADO_FIL,
        IND_FAB_CARBONATOENPIEDRA_FIL,
        IND_FAB_PRECIOTRANSFERENCIA_FIL,
        IND_FAB_VARIOSADH_FIL,
        IND_FAB_OTROSCOSTOSVENTA_FIL,
        IND_VAR_COMISIONES,
        IND_VAR_MANIOBRAS,
        IND_VAR_FLETES,
        IND_OPE_ADMINISTRACION,
        IND_OPE_VENTAS,
        IND_OPE_LOGISTICA,
        IND_OPE_MARKETING,
        IND_OPE_PROYECTOS,
        IND_OPE_DIRECCIONNEGOCIO,
        IND_OPE_CORPORATIVOSTAFF,
        IND_FAB_MOD_STD,
        IND_FAB_MOI_STD,
        IND_FAB_ELECTRICIDAD_STD,
        IND_FAB_DEPRECIACION_STD,
        IND_FAB_MANTENIMIENTO_STD,
        IND_FAB_GASTOSINDIRECTOS_STD,
        IND_FAB_EMPAQUE_STD,
        IND_FAB_CEMENTOS_STD,
        IND_FAB_QUIMICOSMP_STD,
        IND_FAB_CARGASQUIMICAS_STD,
        IND_FAB_PTCOMPRADO_STD,
        IND_FAB_CARBONATOCOMPRADO_STD,
        IND_FAB_CARBONATOENPIEDRA_STD,
        IND_FAB_SUBCONTRATACIONMAQUILA_STD,
        IND_FAB_VARIOSADH_STD,
        0 as IND_FAB_PTMAQUILA_STD,
        SISORIGEN_ID,
        MANDANTE,
        FECHA_CARGA,
        ZONA_HORARIA   

FROM CON.FCT_FIN_ADH_RENTABILIDAD

UNION ALL

SELECT 
        FECHA_CONTABILIZACION,
        ANIO_MES,
        EJERCICIO,
        PERIODO,
        CASE WHEN   PERIODO = '001' THEN'Ene'
             WHEN PERIODO = '002' THEN  'Feb'
             WHEN PERIODO = '003' THEN  'Mar'
             WHEN PERIODO = '004' THEN 'Abr'
             WHEN PERIODO = '005' THEN 'May'
             WHEN PERIODO = '006' THEN 'Jun'
             WHEN PERIODO = '007' THEN 'Jul'
             WHEN PERIODO = '008' THEN 'Ago'
             WHEN PERIODO = '009' THEN 'Sep'
             WHEN PERIODO = '010' THEN 'Oct'
             WHEN PERIODO = '011' THEN 'Nov'
             WHEN PERIODO = '012' THEN 'Dic' END AS PERIODO_NOMBRE,
        FECHA_DOCUMENTO,
        SOCIEDADCO_ID,
        SOCIEDAD_ID,
        ORGVENTAS_ID,
        CANALDISTRIB_ID,
        SECTOR_ID,
        CENTRO_ID,
        OFICINAVENTAS_ID,
        CENTROBENEFICIO_ID,
        CENTROCOSTO_ID,
        CUENTA_ID,
        CLIENTE_ID,
        SOLICITANTE_ID,
        DESTINATARIO_ID,
        GRUPOSOLICITANTE_ID,
        CONSTRUCTORA_ID,
        TIPO_OBRA_ID,
        ID_PLAN_DE_OBRA,
        PAIS_ID,
        PAISCLIENTE_ID,
        REGION_ID,
        ZONATRANSPORTE_ID,
        MATERIAL_ID,
        CLAVE_MONEDA,
        UNIDAD_MEDIDA,
        CENTROCOSTO_GRUPO_ID,
        CUENTA_GRUPO_ID,
        CONVENIO_OBRA,
        '' AS CENTRO_VENTA,
        '' AS CENTRO_FABRICACION,
        IND_HSL,
        IND_QUANT2,
        IND_FAB_COSTOVENTAFIJO,
        IND_VTA_IMP_PRECIOLISTA_ML,
        IND_VTA_IMP_DESCUENTOS_ML,
        IND_VTA_IMP_PROMOCIONES_ML,
        IND_VTA_IMP_RAPPELES_ML,
        IND_VTA_IMP_CORRECTIVAS_ML,
        IND_VTA_IMP_VENTAREAL_ML,
        IND_VTA_IMP_VENTAREAL_TON,
        IND_VTA_PRECIO_CONSTRUCTORA_ML,
        IND_VTA_IMP_CONSTRUCTORA_ML,
        IND_FAB_MOD,
        IND_FAB_MOI,
        IND_FAB_ELECTRICIDAD,
        IND_FAB_DEPRECIACION,
        IND_FAB_MANTENIMIENTO,
        IND_FAB_GASTOSINDIRECTOS,
        IND_FAB_EMPAQUE,
        IND_FAB_CEMENTOS,
        IND_FAB_QUIMICOSMP,
        IND_FAB_CARGASQUIMICAS,
        IND_FAB_PTCOMPRADO,
        IND_FAB_CARBONATOCOMPRADO,
        IND_FAB_CARBONATOPIEDRA,
        IND_FAB_SUBCONTRATACIONMAQUILA,
        IND_FAB_OTROCOSTOSVENTA,
        IND_FAB_VARIOSADH,
        IND_FAB_PTMAQUILA,
        IND_FAB_MOD_FIL,
        IND_FAB_MOI_FIL,
        IND_FAB_ELECTRICIDAD_FIL,
        IND_FAB_DEPRECIACION_FIL,
        IND_FAB_MANTENIMIENTO_FIL,
        IND_FAB_GASTOSINDIRECTOS_FIL,
        IND_FAB_EMPAQUE_FIL,
        IND_FAB_CEMENTOS_FIL,
        IND_FAB_QUIMICOSMP_FIL,
        IND_FAB_CARGASQUIMICAS_FIL,
        IND_FAB_CARBONATOCOMPRADO_FIL,
        IND_FAB_CARBONATOENPIEDRA_FIL,
        IND_FAB_PRECIOTRANSFERENCIA_FIL,
        IND_FAB_VARIOSADH_FIL,
        IND_FAB_OTROSCOSTOSVENTA_FIL,
        IND_VAR_COMISIONES,
        IND_VAR_MANIOBRAS,
        IND_VAR_FLETES,
        IND_OPE_ADMINISTRACION,
        IND_OPE_VENTAS,
        IND_OPE_LOGISTICA,
        IND_OPE_MARKETING,
        IND_OPE_PROYECTOS,
        IND_OPE_DIRECCIONNEGOCIO,
        IND_OPE_CORPORATIVOSTAFF,
        IND_FAB_MOD_STD,
        IND_FAB_MOI_STD,
        IND_FAB_ELECTRICIDAD_STD,
        IND_FAB_DEPRECIACION_STD,
        IND_FAB_MANTENIMIENTO_STD,
        IND_FAB_GASTOSINDIRECTOS_STD,
        IND_FAB_EMPAQUE_STD,
        IND_FAB_CEMENTOS_STD,
        IND_FAB_QUIMICOSMP_STD,
        IND_FAB_CARGASQUIMICAS_STD,
        IND_FAB_PTCOMPRADO_STD,
        IND_FAB_CARBONATOCOMPRADO_STD,
        IND_FAB_CARBONATOENPIEDRA_STD,
        IND_FAB_SUBCONTRATACIONMAQUILA_STD,
        IND_FAB_VARIOSADH_STD,
        IND_FAB_PTMAQUILA_STD,
        SISORIGEN_ID,
        MANDANTE,
        FECHA_CARGA,
        ZONA_HORARIA   

FROM CON.FCT_FIN_ADH_RENTABILIDAD_HIST;

create or REPLACE stream MIRRORING.STREAM_VW_FCT_FIN_ADH_RENTABILIDAD on view MIRRORING.VW_FCT_FIN_ADH_RENTABILIDAD;

