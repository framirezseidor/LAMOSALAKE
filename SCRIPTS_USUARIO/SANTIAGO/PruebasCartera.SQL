INSERT INTO CON.FCT_FIN_CARTERAACT
		SELECT  ANIO,
                MES,
                ANIO_MES,
                SOCIEDAD_ID,
                ORGVENTAS_ID,
                CANALDISTRIB_ID,
                SECTOR_ID,
                OFICINAVENTAS_ID,
                DEUDOR_ID,
                PAIS_ID,
                SOLICITANTE,
                SOLICITANTE_ID,
                DESTINATARIO,
                DESTINATARIO_ID,
                CLASEDOCFI_ID,
                DOCUMENTOFI,
                CENTROBENEFICIO_ID,
                CUENTALIBROMAYOR_ID,
                DOCREFERENCIA,
                FACTURA,
                CLASEFACTURA_ID,
                ASESORFACTURA_ID,
                ASESORFACTURA_TEXT,
                AREACTRLCDTO_ID,
                CLASERIESGO_ID,
                EQUIPORESPCREDITO_ID,
                EQUIPORESPCREDITO_TEXT,
                GRUPOCREDCLIENTE_ID,
                GRUPCREDCLIENTE_TEXT,
                FECHACONTAB,
                FECHA_VENCIMIENTO,
                FECHA_CLAVE,
                IND_IMP_CARTERA_TOTAL_MDOC,
                IND_IMP_VENCIDO_030_MDOC,
                IND_IMP_VENCIDO_3160_MDOC,
                IND_IMP_VENCIDO_6190_MDOC,
                IND_IMP_VENCIDO_MAYOR90_MDOC,
                IND_IMP_VENCIDO_TOTAL_MDOC,
                IND_IMP_PORVENCER_030_MDOC,
                IND_IMP_PORVENCER_3160_MDOC,
                IND_IMP_PORVENCER_6190_MDOC,
                IND_IMP_PORVENCER_MAYOR90_MDOC,
                IND_IMP_PORVENCER_TOTAL_MDOC,
                IND_IMP_COBRANZA_MDOC,
                IND_IMP_FACTURAS_MDOC,
                MON_DOC,
                IND_IMP_CARTERA_TOTAL_MSOC,
                IND_IMP_VENCIDO_030_MSOC,
                IND_IMP_VENCIDO_3160_MSOC,
                IND_IMP_VENCIDO_6190_MSOC,
                IND_IMP_VENCIDO_MAYOR90_MSOC,
                IND_IMP_VENCIDO_TOTAL_MSOC,
                IND_IMP_PORVENCER_030_MSOC,
                IND_IMP_PORVENCER_3160_MSOC,
                IND_IMP_PORVENCER_6190_MSOC,
                IND_IMP_PORVENCER_MAYOR90_MSOC,
                IND_IMP_PORVENCER_TOTAL_MSOC,
                IND_IMP_COBRANZA_MSOC,
                IND_IMP_FACTURAS_MSOC,
                MON_SOC,
                IND_IMP_CARTERA_TOTAL_MUSD,
                IND_IMP_VENCIDO_030_MUSD,
                IND_IMP_VENCIDO_3160_MUSD,
                IND_IMP_VENCIDO_6190_MUSD,
                IND_IMP_VENCIDO_MAYOR90_MUSD,
                IND_IMP_VENCIDO_TOTAL_MUSD,
                IND_IMP_PORVENCER_030_MUSD,
                IND_IMP_PORVENCER_3160_MUSD,
                IND_IMP_PORVENCER_6190_MUSD,
                IND_IMP_PORVENCER_MAYOR90_MUSD,
                IND_IMP_PORVENCER_TOTAL_MUSD,
                IND_IMP_COBRANZA_MUSD,
                IND_IMP_FACTURAS_MUSD,
                MON_USD,
                TIPO

        FROM (

            SELECT  ANIO,
                    MES,
                    ANIO_MES,
                    SOCIEDAD_ID,
                    ORGVENTAS_ID,
                    CANALDISTRIB_ID,
                    SECTOR_ID,
                    OFICINAVENTAS_ID,
                    DEUDOR_ID,
                    PAIS_ID,
                    SOLICITANTE,
                    SOLICITANTE_ID,
                    DESTINATARIO,
                    DESTINATARIO_ID,
                    CLASEDOCFI_ID,
                    DOCUMENTOFI,
                    CENTROBENEFICIO_ID,
                    CUENTALIBROMAYOR_ID,
                    DOCREFERENCIA,
                    FACTURA,
                    CLASEFACTURA_ID,
                    ASESORFACTURA_ID,
                    ASESORFACTURA_TEXT,
                    AREACTRLCDTO_ID,
                    CLASERIESGO_ID,
                    EQUIPORESPCREDITO_ID,
                    EQUIPORESPCREDITO_TEXT,
                    GRUPOCREDCLIENTE_ID,
                    GRUPCREDCLIENTE_TEXT,
                    FECHA_CONTAB AS FECHACONTAB,
                    FECHA_VENCIMIENTO,
                    FECHA_CLAVE,
                    IND_IMP_CARTERA_TOTAL_MDOC,
                    IND_IMP_VENCIDO_030_MDOC,
                    IND_IMP_VENCIDO_3160_MDOC,
                    IND_IMP_VENCIDO_6190_MDOC,
                    IND_IMP_VENCIDO_MAYOR90_MDOC,
                    IND_IMP_VENCIDO_TOTAL_MDOC,
                    IND_IMP_PORVENCER_030_MDOC,
                    IND_IMP_PORVENCER_3160_MDOC,
                    IND_IMP_PORVENCER_6190_MDOC,
                    IND_IMP_PORVENCER_MAYOR90_MDOC,
                    IND_IMP_PORVENCER_TOTAL_MDOC,
                    IND_IMP_COBRANZA_MDOC,
                    IND_IMP_FACTURAS_MDOC,
                    MON_DOC,
                    IND_IMP_CARTERA_TOTAL_MSOC,
                    IND_IMP_VENCIDO_030_MSOC,
                    IND_IMP_VENCIDO_3160_MSOC,
                    IND_IMP_VENCIDO_6190_MSOC,
                    IND_IMP_VENCIDO_MAYOR90_MSOC,
                    IND_IMP_VENCIDO_TOTAL_MSOC,
                    IND_IMP_PORVENCER_030_MSOC,
                    IND_IMP_PORVENCER_3160_MSOC,
                    IND_IMP_PORVENCER_6190_MSOC,
                    IND_IMP_PORVENCER_MAYOR90_MSOC,
                    IND_IMP_PORVENCER_TOTAL_MSOC,
                    IND_IMP_COBRANZA_MSOC,
                    IND_IMP_FACTURAS_MSOC,
                    MON_SOC,
                    IND_IMP_CARTERA_TOTAL_MUSD,
                    IND_IMP_VENCIDO_030_MUSD,
                    IND_IMP_VENCIDO_3160_MUSD,
                    IND_IMP_VENCIDO_6190_MUSD,
                    IND_IMP_VENCIDO_MAYOR90_MUSD,
                    IND_IMP_VENCIDO_TOTAL_MUSD,
                    IND_IMP_PORVENCER_030_MUSD,
                    IND_IMP_PORVENCER_3160_MUSD,
                    IND_IMP_PORVENCER_6190_MUSD,
                    IND_IMP_PORVENCER_MAYOR90_MUSD,
                    IND_IMP_PORVENCER_TOTAL_MUSD,
                    IND_IMP_COBRANZA_MUSD,
                    IND_IMP_FACTURAS_MUSD,
                    MON_USD,
                    TIPO
            FROM PRE.PFCT_FIN_CARTERAACT
            WHERE ANIO_MES = '202505' --:ANIOMES
        
            UNION ALL

            SELECT  ANIO,
                    MES,
                    ANIO_MES,
                    SOCIEDAD_ID,
                    ORGVENTAS_ID,
                    CANALDISTRIB_ID,
                    SECTOR_ID,
                    OFICINAVENTAS_ID,
                    DEUDOR_ID,
                    '' AS PAIS_ID,
                    SOLICITANTE,
                    SOLICITANTE_ID,
                    DESTINATARIO,
                    DESTINATARIO_ID,
                    CLASEDOCFI_ID,
                    DOCUMENTOFI,
                    CENTROBENEFICIO_ID,
                    CUENTALIBROMAYOR_ID,
                    DOCREFERENCIA,
                    FACTURA,
                    CLASEFACTURA_ID,
                    ASESORFACTURA_ID,
                    ASESORFACTURA_TEXT,
                    AREACTRLCDTO_ID,
                    CLASERIESGO_ID,
                    EQUIPORESPCREDITO_ID,
                    EQUIPORESPCREDITO_TEXT,
                    GRUPOCREDCLIENTE_ID,
                    GRUPCREDCLIENTE_TEXT,
                    FECHACONTAB,
                    FECHAVENCIMIENTO,
                    FECHACLAVE,
                    0 AS IND_IMP_CARTERA_TOTAL_MDOC,
                    0 AS IND_IMP_VENCIDO_030_MDOC,
                    0 AS IND_IMP_VENCIDO_3160_MDOC,
                    0 AS IND_IMP_VENCIDO_6190_MDOC,
                    0 AS IND_IMP_VENCIDO_MAYOR90_MDOC,
                    0 AS IND_IMP_VENCIDO_TOTAL_MDOC,
                    0 AS IND_IMP_PORVENCER_030_MDOC,
                    0 AS IND_IMP_PORVENCER_3160_MDOC,
                    0 AS IND_IMP_PORVENCER_6190_MDOC,
                    0 AS IND_IMP_PORVENCER_MAYOR90_MDOC,
                    0 AS IND_IMP_PORVENCER_TOTAL_MDOC,
                    IND_IMP_COBRANZA_MDOC,
                    0 AS IND_IMP_FACTURAS_MDOC,
                    MON_DOC,
                    0 AS IND_IMP_CARTERA_TOTAL_MSOC,
                    0 AS IND_IMP_VENCIDO_030_MSOC,
                    0 AS IND_IMP_VENCIDO_3160_MSOC,
                    0 AS IND_IMP_VENCIDO_6190_MSOC,
                    0 AS IND_IMP_VENCIDO_MAYOR90_MSOC,
                    0 AS IND_IMP_VENCIDO_TOTAL_MSOC,
                    0 AS IND_IMP_PORVENCER_030_MSOC,
                    0 AS IND_IMP_PORVENCER_3160_MSOC,
                    0 AS IND_IMP_PORVENCER_6190_MSOC,
                    0 AS IND_IMP_PORVENCER_MAYOR90_MSOC,
                    0 AS IND_IMP_PORVENCER_TOTAL_MSOC,
                    IND_IMP_COBRANZA_MSOC,
                    0 AS IND_IMP_FACTURAS_MSOC,
                    MON_SOC,
                    0 AS IND_IMP_CARTERA_TOTAL_MUSD,
                    0 AS IND_IMP_VENCIDO_030_MUSD,
                    0 AS IND_IMP_VENCIDO_3160_MUSD,
                    0 AS IND_IMP_VENCIDO_6190_MUSD,
                    0 AS IND_IMP_VENCIDO_MAYOR90_MUSD,
                    0 AS IND_IMP_VENCIDO_TOTAL_MUSD,
                    0 AS IND_IMP_PORVENCER_030_MUSD,
                    0 AS IND_IMP_PORVENCER_3160_MUSD,
                    0 AS IND_IMP_PORVENCER_6190_MUSD,
                    0 AS IND_IMP_PORVENCER_MAYOR90_MUSD,
                    0 AS IND_IMP_PORVENCER_TOTAL_MUSD,
                    IND_IMP_COBRANZA_MUSD,
                    0 AS IND_IMP_FACTURAS_MUSD,
                    MON_USD,
                    '' AS TIPO
            FROM CON.FCT_FIN_COBRANZA
            WHERE ANIO_MES = '202505' --:ANIOMES
        
            UNION ALL

            SELECT  ANIO,
                    MES,
                    ANIO_MES,
                    SOCIEDAD_ID,
                    ORGVENTAS_ID,
                    CANALDISTRIB_ID,
                    SECTOR_ID,
                    OFICINAVENTAS_ID,
                    DEUDOR_ID,
                    '' AS PAIS_ID,
                    SOLICITANTE,
                    SOLICITANTE_ID,
                    DESTINATARIO,
                    DESTINATARIO_ID,
                    CLASEDOCFI_ID,
                    DOCUMENTOFI,
                    CENTROBENEFICIO_ID,
                    CUENTALIBROMAYOR_ID,
                    DOCREFERENCIA,
                    FACTURA,
                    CLASEFACTURA_ID,
                    ASESORFACTURA_ID,
                    ASESORFACTURA_TEXT,
                    AREACTRLCDTO_ID,
                    CLASERIESGO_ID,
                    EQUIPORESPCREDITO_ID,
                    EQUIPORESPCREDITO_TEXT,
                    GRUPOCREDCLIENTE_ID,
                    GRUPCREDCLIENTE_TEXT,
                    FECHACONTAB,
                    FECHAVENCIMIENTO,
                    FECHACLAVE,
                    0 AS IND_IMP_CARTERA_TOTAL_MDOC,
                    0 AS IND_IMP_VENCIDO_030_MDOC,
                    0 AS IND_IMP_VENCIDO_3160_MDOC,
                    0 AS IND_IMP_VENCIDO_6190_MDOC,
                    0 AS IND_IMP_VENCIDO_MAYOR90_MDOC,
                    0 AS IND_IMP_VENCIDO_TOTAL_MDOC,
                    0 AS IND_IMP_PORVENCER_030_MDOC,
                    0 AS IND_IMP_PORVENCER_3160_MDOC,
                    0 AS IND_IMP_PORVENCER_6190_MDOC,
                    0 AS IND_IMP_PORVENCER_MAYOR90_MDOC,
                    0 AS IND_IMP_PORVENCER_TOTAL_MDOC,
                    0 AS IND_IMP_COBRANZA_MDOC,
                    IND_IMP_FACTURAS_MDOC,
                    MON_DOC,
                    0 AS IND_IMP_CARTERA_TOTAL_MSOC,
                    0 AS IND_IMP_VENCIDO_030_MSOC,
                    0 AS IND_IMP_VENCIDO_3160_MSOC,
                    0 AS IND_IMP_VENCIDO_6190_MSOC,
                    0 AS IND_IMP_VENCIDO_MAYOR90_MSOC,
                    0 AS IND_IMP_VENCIDO_TOTAL_MSOC,
                    0 AS IND_IMP_PORVENCER_030_MSOC,
                    0 AS IND_IMP_PORVENCER_3160_MSOC,
                    0 AS IND_IMP_PORVENCER_6190_MSOC,
                    0 AS IND_IMP_PORVENCER_MAYOR90_MSOC,
                    0 AS IND_IMP_PORVENCER_TOTAL_MSOC,
                    0 AS IND_IMP_COBRANZA_MSOC,
                    IND_IMP_FACTURAS_MSOC,
                    MON_SOC,
                    0 AS IND_IMP_CARTERA_TOTAL_MUSD,
                    0 AS IND_IMP_VENCIDO_030_MUSD,
                    0 AS IND_IMP_VENCIDO_3160_MUSD,
                    0 AS IND_IMP_VENCIDO_6190_MUSD,
                    0 AS IND_IMP_VENCIDO_MAYOR90_MUSD,
                    0 AS IND_IMP_VENCIDO_TOTAL_MUSD,
                    0 AS IND_IMP_PORVENCER_030_MUSD,
                    0 AS IND_IMP_PORVENCER_3160_MUSD,
                    0 AS IND_IMP_PORVENCER_6190_MUSD,
                    0 AS IND_IMP_PORVENCER_MAYOR90_MUSD,
                    0 AS IND_IMP_PORVENCER_TOTAL_MUSD,
                    0 AS IND_IMP_COBRANZA_MUSD,
                    IND_IMP_FACTURAS_MUSD,
                    MON_USD,
                    '' AS TIPO
            FROM CON.FCT_FIN_FACTURADO
            WHERE ANIO_MES = '202505' --:ANIOMES
        );

SELECT *
FROM CON.FCT_FIN_FACTURADO
WHERE ANIO_MES = '202505' --:ANIOMES
AND (CLASERIESGO_ID = '0010105291' OR SOLICITANTE_ID = '0010105291' OR DOCUMENTOFI = '0010105291' OR GRUPOCREDCLIENTE_ID = '0010105291');



SELECT  SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA_TOTAL_MDOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MDOC) AS VENCIDO_TOTAL_MDOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MDOC) AS PORVENCER_TOTAL_MDOC,
        SUM(IND_IMP_COBRANZA_MDOC) AS COBRANZA_MDOC,
        SUM(IND_IMP_FACTURAS_MDOC) AS FACTURAS_MDOC,
        SUM(IND_IMP_CARTERA_TOTAL_MSOC) AS CARTERA_TOTAL_MSOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MSOC) AS VENCIDO_TOTAL_MSOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MSOC) AS PORVENCER_TOTAL_MSOC,
        SUM(IND_IMP_COBRANZA_MSOC) AS COBRANZA_MSOC,
        SUM(IND_IMP_FACTURAS_MSOC) AS FACTURAS_MSOC,
        SUM(IND_IMP_CARTERA_TOTAL_MUSD) AS CARTERA_TOTAL_MUSD,
        SUM(IND_IMP_VENCIDO_TOTAL_MUSD) AS VENCIDO_TOTAL_MUSD,
        SUM(IND_IMP_PORVENCER_TOTAL_MUSD) AS PORVENCER_TOTAL_MUSD,
        SUM(IND_IMP_COBRANZA_MUSD) AS COBRANZA_MUSD,
        SUM(IND_IMP_FACTURAS_MUSD) AS FACTURAS_MUSD
FROM CON.FCT_FIN_CARTERAHIST;

SELECT  SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA_TOTAL_MDOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MDOC) AS VENCIDO_TOTAL_MDOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MDOC) AS PORVENCER_TOTAL_MDOC,
        SUM(IND_IMP_COBRANZA_MDOC) AS COBRANZA_MDOC,
        SUM(IND_IMP_FACTURAS_MDOC) AS FACTURAS_MDOC,
        SUM(IND_IMP_CARTERA_TOTAL_MSOC) AS CARTERA_TOTAL_MSOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MSOC) AS VENCIDO_TOTAL_MSOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MSOC) AS PORVENCER_TOTAL_MSOC,
        SUM(IND_IMP_COBRANZA_MSOC) AS COBRANZA_MSOC,
        SUM(IND_IMP_FACTURAS_MSOC) AS FACTURAS_MSOC,
        SUM(IND_IMP_CARTERA_TOTAL_MUSD) AS CARTERA_TOTAL_MUSD,
        SUM(IND_IMP_VENCIDO_TOTAL_MUSD) AS VENCIDO_TOTAL_MUSD,
        SUM(IND_IMP_PORVENCER_TOTAL_MUSD) AS PORVENCER_TOTAL_MUSD,
        SUM(IND_IMP_COBRANZA_MUSD) AS COBRANZA_MUSD,
        SUM(IND_IMP_FACTURAS_MUSD) AS FACTURAS_MUSD
FROM MIRRORING.FCT_FIN_ADH_CARTERA;
SELECT  SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA_TOTAL_MDOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MDOC) AS VENCIDO_TOTAL_MDOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MDOC) AS PORVENCER_TOTAL_MDOC,
        SUM(IND_IMP_COBRANZA_MDOC) AS COBRANZA_MDOC,
        SUM(IND_IMP_FACTURAS_MDOC) AS FACTURAS_MDOC,
        SUM(IND_IMP_CARTERA_TOTAL_MSOC) AS CARTERA_TOTAL_MSOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MSOC) AS VENCIDO_TOTAL_MSOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MSOC) AS PORVENCER_TOTAL_MSOC,
        SUM(IND_IMP_COBRANZA_MSOC) AS COBRANZA_MSOC,
        SUM(IND_IMP_FACTURAS_MSOC) AS FACTURAS_MSOC,
        SUM(IND_IMP_CARTERA_TOTAL_MUSD) AS CARTERA_TOTAL_MUSD,
        SUM(IND_IMP_VENCIDO_TOTAL_MUSD) AS VENCIDO_TOTAL_MUSD,
        SUM(IND_IMP_PORVENCER_TOTAL_MUSD) AS PORVENCER_TOTAL_MUSD,
        SUM(IND_IMP_COBRANZA_MUSD) AS COBRANZA_MUSD,
        SUM(IND_IMP_FACTURAS_MUSD) AS FACTURAS_MUSD
FROM MIRRORING.FCT_FIN_REV_CARTERA;
SELECT  SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA_TOTAL_MDOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MDOC) AS VENCIDO_TOTAL_MDOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MDOC) AS PORVENCER_TOTAL_MDOC,
        SUM(IND_IMP_COBRANZA_MDOC) AS COBRANZA_MDOC,
        SUM(IND_IMP_FACTURAS_MDOC) AS FACTURAS_MDOC,
        SUM(IND_IMP_CARTERA_TOTAL_MSOC) AS CARTERA_TOTAL_MSOC,
        SUM(IND_IMP_VENCIDO_TOTAL_MSOC) AS VENCIDO_TOTAL_MSOC,
        SUM(IND_IMP_PORVENCER_TOTAL_MSOC) AS PORVENCER_TOTAL_MSOC,
        SUM(IND_IMP_COBRANZA_MSOC) AS COBRANZA_MSOC,
        SUM(IND_IMP_FACTURAS_MSOC) AS FACTURAS_MSOC,
        SUM(IND_IMP_CARTERA_TOTAL_MUSD) AS CARTERA_TOTAL_MUSD,
        SUM(IND_IMP_VENCIDO_TOTAL_MUSD) AS VENCIDO_TOTAL_MUSD,
        SUM(IND_IMP_PORVENCER_TOTAL_MUSD) AS PORVENCER_TOTAL_MUSD,
        SUM(IND_IMP_COBRANZA_MUSD) AS COBRANZA_MUSD,
        SUM(IND_IMP_FACTURAS_MUSD) AS FACTURAS_MUSD
FROM MIRRORING.VW_FCT_FIN_REV_CARTERA;

CALL CON.SP_CON_FACT_CARTERAACT('202505');
CALL CON.SP_CON_FACT_CARTERAHIST('202505');

SELECT COUNT(*)
FROM MIRRORING.FCT_FIN_ADH_CARTERA;




SELECT SUM(IND_IMP_COBRANZA_MDOC), SUM(IND_IMP_FACTURAS_MDOC) FROM CON.FCT_FIN_CARTERAHIST;






SELECT *
FROM MIRRORING.TR_FCT_FIN_ADH_CARTERA;

SELECT *
FROM CON.FCT_FIN_CARTERAHIST_HIST;




SELECT * 
from "RAW"."PARAMETROS_EXTRACCION"
where "EXTRACTOR" = 'ZBWFI_REP_ANTSALDET'
and "NEGOCIO" in ('ADH_MEX', 'ADH_GUATEMALA')
and "PARAMETRO" = 'BUDAT';

DELETE from "RAW"."PARAMETROS_EXTRACCION" 
where "EXTRACTOR" = 'ZBWFI_REP_ANTSALDET' 
	and "NEGOCIO" in ('ADH_MEX', 'ADH_GUATEMALA') 
	and "PARAMETRO" = 'BUDAT';

INSERT INTO "LAMOSALAKE_DEV"."RAW"."PARAMETROS_EXTRACCION"
VALUES ('1','ZBWFI_REP_ANTSALDET','ADH_MEX','BUDAT','20250731','20250731'),
('1','ZBWFI_REP_ANTSALDET','ADH_GUATEMALA','BUDAT','20250731','20250731');



SELECT COUNT(*)
FROM (
    SELECT *
    FROM CON.FCT_FIN_CARTERAACT
    
    UNION ALL

    SELECT *
    FROM CON.FCT_FIN_CARTERAHIST
)
WHERE FECHACLAVE = '2025-07-23'
AND SOCIEDAD_ID BETWEEN 'A101' AND 'A201';


SELECT COUNT(*)
FROM CON.FCT_FIN_CARTERAACT
WHERE FECHACLAVE = '2025-07-23'
AND SOCIEDAD_ID BETWEEN 'A101' AND 'A201';

SELECT COUNT(*)
FROM CON.VW_FCT_FIN_ADH_CARTERA
WHERE FECHACLAVE = '2025-07-23'
AND SOCIEDAD_ID BETWEEN 'A101' AND 'A201';




SELECT COUNT(*)
FROM MIRRORING.VW_FCT_FIN_ADH_CARTERA
WHERE FECHACLAVE = '2025-07-23'
AND SOCIEDAD_ID BETWEEN 'A101' AND 'A201';


SELECT COUNT(*)
FROM MIRRORING.FCT_FIN_ADH_CARTERA
WHERE FECHACLAVE = '2025-07-23'
AND SOCIEDAD_ID BETWEEN 'A101' AND 'A201';


SELECT COUNT(*)
FROM MIRRORING.VW_FCT_FIN_ADH_CARTERA
WHERE SOCIEDAD_ID BETWEEN 'A101' AND 'A201';

SELECT COUNT(*)
FROM MIRRORING.FCT_FIN_ADH_CARTERA
WHERE SOCIEDAD_ID BETWEEN 'A101' AND 'A201';

SELECT DISTINCT ANIO_MES
FROM MIRRORING.VW_FCT_FIN_ADH_CARTERA
ORDER BY ANIO_MES ASC;

SELECT DISTINCT ANIO_MES
FROM MIRRORING.FCT_FIN_ADH_CARTERA
ORDER BY ANIO_MES ASC;



select distinct "RAW"."PARAMETROS_EXTRACCION"."R_INICIO" 
from "RAW"."PARAMETROS_EXTRACCION" 
where "LAMOSALAKE_DEV"."RAW"."PARAMETROS_EXTRACCION"."EXTRACTOR" = 'ZBWFI_REP_ANTSALDET' 
	and "LAMOSALAKE_DEV"."RAW"."PARAMETROS_EXTRACCION"."NEGOCIO" in ('ADH_MEX', 'ADH_GUATEMALA') 
	and "LAMOSALAKE_DEV"."RAW"."PARAMETROS_EXTRACCION"."PARAMETRO" = 'BUDAT';


SELECT DISTINCT ANIO_MES
FROM MIRRORING.FCT_FIN_ADH_CARTERA
WHERE ANIO_MES = '202501'
BETWEEN '202501' AND '202507';

SELECT MAX(FECHA)       
FROM MIRRORING.DIM_CAL_ADH_CARTERA;

WHERE CLASERIESGO = 'C30';
SELECT DISTINCT ANIO_MES
FROM MIRRORING.VW_FCT_FIN_ADH_CARTERA;
WHERE CLASERIESGO = 'C30';
SELECT DISTINCT ANIO_MES
FROM MIRRORING.TR_FCT_FIN_ADH_CARTERA
WHERE ANIO_MES = '202502';
DELETE FROM MIRRORING.TR_FCT_FIN_ADH_CARTERA;

SELECT SYSTEM$USER_TASK_CANCEL_ONGOING_EXECUTIONS('MIRRORING.TASK_FCT_FIN_ADH_CARTERA');


WHERE CLASERIESGO = 'C30';


CALL CON.SP_CON_FACT_CARTERAACT('202507');



SELECT  ANIO,
        MES,
        ANIO_MES,
        SOCIEDAD_ID,
        CANALDISTRIB_ID,
        OFICINAVENTAS_ID,
        FECHACLAVE,
FROM CON.FCT_FIN_CARTERAHIST
WHERE ANIO_MES = '202501';

SELECT *
FROM CON.FCT_FIN_CARTERAACT
WHERE CLASERIESGO = 'C30';


SELECT *
FROM CON.FCT_FIN_CARTERAHIST;


CALL CON.SP_CON_FACT_CARTERAACT('202507');



SELECT  SUBSTR(VALID_FROM,1,4) AS ANIO,
        SUBSTR(VALID_FROM,6,2) AS MES,
        CONCAT(SUBSTR(VALID_FROM,1,4),SUBSTR(VALID_FROM,6,2)) AS ANIO_MES,
        BUKRS AS SOCIEDAD_ID,
        VTWEG AS CANALDISTRIB_ID,
        VKBUR AS OFICINAVENTAS_ID,
        VALID_FROM AS FECHACLAVE,
        CASE WHEN WAERS IN ('COP', 'CLP')
                        THEN (WRBTR) * 100 ELSE (WRBTR)
                        END AS IND_IMP_CARTERA_TOTAL_MDOC
FROM RAW.SQ1_EXT_ZBWFI_REP_ANTSALDET
WHERE VALID_FROM = '2025-07-31';


select *
from "RAW"."PARAMETROS_EXTRACCION" 
where "RAW"."PARAMETROS_EXTRACCION"."EXTRACTOR" = 'ZBWFI_REP_ANTSALDET'
and "RAW"."PARAMETROS_EXTRACCION"."NEGOCIO" in ('ADH_MEX') 
and "RAW"."PARAMETROS_EXTRACCION"."PARAMETRO" = 'BUDAT';

select *
from "RAW"."PARAMETROS_EXTRACCION";

INSERT INTO "RAW"."PARAMETROS_EXTRACCION"
(ORDEN,EXTRACTOR,NEGOCIO,PARAMETRO,R_INICIO,R_FIN) VALUES
('1','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','BUKRS','A101','1'),
('2','ZBWFI_REP_ANTSALDET_ACT','ADH_GUATEMALA','BUKRS','A202','1'),
('3','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','BUKRS','R101','0'),
('4','ZBWFI_REP_ANTSALDET_ACT','REV_USA','BUKRS','','0'),
('5','ZBWFI_REP_ANTSALDET_ACT','REV_ARGENTINA','BUKRS','','0'),
('6','ZBWFI_REP_ANTSALDET_ACT','REV_PERU','BUKRS','','0'),
('7','ZBWFI_REP_ANTSALDET_ACT','REV_COLOMBIA_202','BUKRS','','0'),
('8','ZBWFI_REP_ANTSALDET_ACT','REV_COLOMBIA_204','BUKRS','','0'),
('9','ZBWFI_REP_ANTSALDET_ACT','REV_COLOMBIA_404','BUKRS','','0'),
('10','ZBWFI_REP_ANTSALDET_ACT','REV_CHILE','BUKRS','','0');


SELECT *
FROM "RAW"."PARAMETROS_EXTRACCION"
WHERE EXTRACTOR = 'ZBWFI_REP_ANTSALDET';


INSERT INTO "RAW"."PARAMETROS_EXTRACCION"
(ORDEN,EXTRACTOR,NEGOCIO,PARAMETRO,R_INICIO,R_FIN) VALUES
('1','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','BUKRS','A101','A104'),
('1','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','BUKRS','A201','A202'),
('0','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','BUKRS','A601','A604'),
('1','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','KURST','Z','Z'),
('1','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','WAERK','MXN','MXN'),
('1','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','WAERK','GTQ','GTQ'),
('1','ZBWFI_REP_ANTSALDET_ACT','ADH_MEX','WAERK','CLP','CLP'),

('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','BUKRS','R101','R104'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','BUKRS','R201','R204'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','BUKRS','R401','R404'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','BUKRS','R601','R604'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','KURST','Z','Z'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','WAERK','MXN','MXN'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','WAERK','USD','USD'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','WAERK','ARS','ARS'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','WAERK','PEN','PEN'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','WAERK','COP','COP'),
('0','ZBWFI_REP_ANTSALDET_ACT','REV_MEX','WAERK','CLP','CLP');

DELETE FROM "RAW"."PARAMETROS_EXTRACCION"
WHERE EXTRACTOR = 'ZBWFI_REP_ANTSALDET_ACT';

SELECT EXTRACTOR,NEGOCIO,PARAMETRO,R_INICIO,R_FIN
FROM "RAW"."PARAMETROS_EXTRACCION"
WHERE EXTRACTOR = 'ZBWFI_REP_ANTSALDET_ACT'
AND ORDEN = '1';



INSERT INTO "RAW"."PARAMETROS_EXTRACCION"
(ORDEN,EXTRACTOR,NEGOCIO,PARAMETRO,R_INICIO,R_FIN) VALUES
('1','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','BUKRS','A101','A104'),
('1','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','BUKRS','A201','A202'),
('0','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','BUKRS','A601','A604'),
('1','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','KURST','Z','Z'),
('1','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','WAERK','MXN','MXN'),
('1','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','WAERK','GTQ','GTQ'),
('1','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','WAERK','CLP','CLP'),
('1','ZBWFI_REP_ANTSALDET_HIST','ADH_MEX','BUDAT','20250101','20250131'),

('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','BUKRS','R101','R104'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','BUKRS','R201','R204'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','BUKRS','R401','R404'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','BUKRS','R601','R604'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','KURST','Z','Z'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','WAERK','MXN','MXN'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','WAERK','USD','USD'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','WAERK','ARS','ARS'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','WAERK','PEN','PEN'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','WAERK','COP','COP'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','WAERK','CLP','CLP'),
('0','ZBWFI_REP_ANTSALDET_HIST','REV_MEX','BUDAT','20250101','20250131');

DELETE FROM "RAW"."PARAMETROS_EXTRACCION"
WHERE EXTRACTOR = 'ZBWFI_REP_ANTSALDET_HIST';

SELECT EXTRACTOR,NEGOCIO,PARAMETRO,R_INICIO,R_FIN
FROM "RAW"."PARAMETROS_EXTRACCION"
WHERE EXTRACTOR = 'ZBWFI_REP_ANTSALDET_HIST'
AND ORDEN = '1'
AND PARAMETRO = 'BUDAT';




SELECT DISTINCT MON_DOC, SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA
FROM (
        SELECT  SUBSTR(FACT.VALID_FROM,1,4) AS ANIO,
                SUBSTR(FACT.VALID_FROM,6,2) AS MES,
                CONCAT(SUBSTR(FACT.VALID_FROM,1,4),SUBSTR(FACT.VALID_FROM,6,2)) AS ANIO_MES,
                FACT.BUKRS AS SOCIEDAD_ID,
                FACT.VKORG AS ORGVENTAS_ID,
                FACT.VTWEG AS CANALDISTRIB_ID,
                SECTOR.SPART AS SECTOR_ID,
                FACT.VKBUR AS OFICINAVENTAS_ID,
                LTRIM(FACT.KUNNR, '0') AS DEUDOR_ID,
                PAIS.LAND1 AS PAIS_ID,
                LTRIM(FACT.SOLIC, '0') AS SOLICITANTE,
                CONCAT(FACT.VKORG, '_', FACT.VTWEG, '_', SECTOR.SPART, '_', SOLICITANTE) AS SOLICITANTE_ID,
                LTRIM(FACT.DESTI, '0') AS DESTINATARIO,
                CONCAT(FACT.VKORG, '_', FACT.VTWEG, '_', SECTOR.SPART, '_', DESTINATARIO) AS DESTINATARIO_ID,
                FACT.BLART AS CLASEDOCFI_ID,
                FACT.BELNR AS DOCUMENTOFI,
                FACT.CEBE AS CENTROBENEFICIO_ID,
                FACT.HKONT AS CUENTALIBROMAYOR_ID,
                FACT.XBLNR AS DOCREFERENCIA,
                FACT.VBELN AS FACTURA,
                FACT.FKART AS CLASEFACTURA_ID,
                LTRIM(FACT.ZASESOR, '0') AS ASESORFACTURA_ID,
                FACT.ZNASESOR AS ASESORFACTURA_NAME,
                FACT.KKBER AS AREACTRLCDTO_ID,
                FACT.CTLPC AS CLASERIESGO,
                CONCAT(FACT.KKBER,'_',FACT.CTLPC) AS CLASERIESGO_ID,
                FACT.SBGRP AS EQUIPORESPCREDITO_ID,
                FACT.DESCEQUI AS EQUIPORESPCREDITO_NAME,
                FACT.GRUPP AS GRUPOCREDCLIENTE_ID,
                FACT.DESCGRUP AS GRUPCREDCLIENTE_NAME,
                FACT.BUDAT AS FECHA_CONTAB,
                FACT.ZFVEN AS FECHA_VENCIMIENTO,
                FACT.VALID_FROM AS FECHACLAVE,

                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.WRBTR) * 100 ELSE (FACT.WRBTR)
                        END AS IND_IMP_CARTERA_TOTAL_MDOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.Z0A30V) * 100 ELSE (FACT.Z0A30V)
                        END AS IND_IMP_VENCIDO_030_MDOC, ----------------VENCIDO EDAD 0 - 30
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.Z31A60V) * 100 ELSE (FACT.Z31A60V)
                        END AS IND_IMP_VENCIDO_3160_MDOC, --------------VENCIDO EDAD 31 - 60
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.Z61A90V) * 100 ELSE (FACT.Z61A90V)
                        END AS IND_IMP_VENCIDO_6190_MDOC, --------------VENCIDO EDAD 61 - 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.ZMAY90V) * 100 ELSE (FACT.ZMAY90V)
                        END AS IND_IMP_VENCIDO_MAYOR90_MDOC, -----------VENCIDO EDAD > 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.SVENCIDO) * 100 ELSE (FACT.SVENCIDO)
                        END AS IND_IMP_VENCIDO_TOTAL_MDOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.ZPV0A30) * 100 ELSE (FACT.ZPV0A30)
                        END AS IND_IMP_PORVENCER_030_MDOC, -------------POR VENCER EDAD 0 - 30
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.ZPV31A60) * 100 ELSE (FACT.ZPV31A60)
                        END AS IND_IMP_PORVENCER_3160_MDOC, -----------POR VENCER EDAD 31 - 60
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.ZPV61A90) * 100 ELSE (FACT.ZPV61A90)
                        END AS IND_IMP_PORVENCER_6190_MDOC, -----------POR VENCER EDAD 61 - 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.ZPVM90) * 100 ELSE (FACT.ZPVM90)
                        END AS IND_IMP_PORVENCER_MAYOR90_MDOC, ----------POR VENCER EDAD > 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (FACT.SPORVENCER) * 100 ELSE (FACT.SPORVENCER)
                        END AS IND_IMP_PORVENCER_TOTAL_MDOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (NULL) * 100 ELSE (NULL) END AS IND_IMP_COBRANZA_MDOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (NULL) * 100 ELSE (NULL) END AS IND_IMP_FACTURAS_MDOC,
                FACT.WAERS AS MON_DOC, ------------------------------MONEDA DOCUMENTO
                
                FACT.UKURSB AS TIPOCAMBIO_MONSOC, -------------------TIPO DE CAMBIO - MONEDA SOCIEDAD
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_CARTERA_TOTAL_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_CARTERA_TOTAL_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_CARTERA_TOTAL_MSOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_030_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_VENCIDO_030_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_VENCIDO_030_MSOC, ----------------VENCIDO EDAD 0 - 30
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_3160_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_VENCIDO_3160_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_VENCIDO_3160_MSOC, --------------VENCIDO EDAD 31 - 60
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_6190_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_VENCIDO_6190_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_VENCIDO_6190_MSOC, --------------VENCIDO EDAD 61 - 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_MAYOR90_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_VENCIDO_MAYOR90_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_VENCIDO_MAYOR90_MSOC, -----------VENCIDO EDAD > 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_TOTAL_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_VENCIDO_TOTAL_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_VENCIDO_TOTAL_MSOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_030_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_PORVENCER_030_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_PORVENCER_030_MSOC, -------------POR VENCER EDAD 0 - 30
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_3160_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_PORVENCER_3160_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_PORVENCER_3160_MSOC, -----------POR VENCER EDAD 31 - 60
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_6190_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_PORVENCER_6190_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_PORVENCER_6190_MSOC, -----------POR VENCER EDAD 61 - 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_MAYOR90_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_PORVENCER_MAYOR90_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_PORVENCER_MAYOR90_MSOC, ----------POR VENCER EDAD > 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_TOTAL_MDOC * TIPOCAMBIO_MONSOC) * 100
                        ELSE (IND_IMP_PORVENCER_TOTAL_MDOC * TIPOCAMBIO_MONSOC)
                        END AS IND_IMP_PORVENCER_TOTAL_MSOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (NULL) * 100 ELSE NULL
                        END AS IND_IMP_COBRANZA_MSOC,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (NULL) * 100 ELSE NULL
                        END AS IND_IMP_FACTURAS_MSOC,
                FACT.BWAERS AS MON_SOC, -----------------------------MONEDA SOCIEDAD
                
                FACT.UKURSU AS TIPOCAMBIO_MONUSD, -------------------TIPO DE CAMBIO - MONEDA USD
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_CARTERA_TOTAL_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_CARTERA_TOTAL_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_CARTERA_TOTAL_MUSD,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_030_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_VENCIDO_030_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_VENCIDO_030_MUSD, ----------------VENCIDO EDAD 0 - 30
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_3160_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_VENCIDO_3160_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_VENCIDO_3160_MUSD, --------------VENCIDO EDAD 31 - 60
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_6190_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_VENCIDO_6190_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_VENCIDO_6190_MUSD, --------------VENCIDO EDAD 61 - 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_MAYOR90_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_VENCIDO_MAYOR90_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_VENCIDO_MAYOR90_MUSD, -----------VENCIDO EDAD > 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_VENCIDO_total_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_VENCIDO_total_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_VENCIDO_total_MUSD,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_030_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_PORVENCER_030_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_PORVENCER_030_MUSD, -------------POR VENCER EDAD 0 - 30
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_3160_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_PORVENCER_3160_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_PORVENCER_3160_MUSD, -----------POR VENCER EDAD 31 - 60
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_6190_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_PORVENCER_6190_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_PORVENCER_6190_MUSD, -----------POR VENCER EDAD 61 - 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_MAYOR90_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_PORVENCER_MAYOR90_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_PORVENCER_MAYOR90_MUSD, ----------POR VENCER EDAD > 90
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (IND_IMP_PORVENCER_TOTAL_MDOC * TIPOCAMBIO_MONUSD) * 100
                        ELSE (IND_IMP_PORVENCER_TOTAL_MDOC * TIPOCAMBIO_MONUSD)
                        END AS IND_IMP_PORVENCER_TOTAL_MUSD,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (NULL) * 100 ELSE NULL
                        END AS IND_IMP_COBRANZA_MUSD,
                CASE WHEN FACT.WAERS IN ('COP', 'CLP')
                        THEN (NULL) * 100 ELSE NULL
                        END AS IND_IMP_FACTURAS_MUSD,
                FACT.LWAERS AS MON_USD, -----------------------------MONEDA USD

                FACT.KURST AS TIPOCOTIZACION,
                FACT.TIPO AS TIPO,
        FROM (
                (SELECT BUDAT,
                        BUKRS,
                        VKORG,
                        VTWEG,
                        VKBUR,
                        KUNNR,
                        SOLIC,
                        DESTI,
                        BLART,
                        BELNR,
                        CEBE,
                        HKONT,
                        XBLNR,
                        VBELN,
                        FKART,
                        ZASESOR,
                        ZNASESOR,
                        KKBER,
                        CTLPC,
                        SBGRP,
                        DESCEQUI,
                        GRUPP,
                        DESCGRUP,
                        ZFVEN,
                        WRBTR,
                        Z0A30V,
                        Z31A60V,
                        Z61A90V,
                        ZMAY90V,
                        SVENCIDO,
                        ZPV0A30,
                        ZPV31A60,
                        ZPV61A90,
                        ZPVM90,
                        SPORVENCER,
                        WAERS,
                        UKURSB,
                        BWAERS,
                        UKURSU,
                        LWAERS,
                        KURST,
                        VALID_FROM,
                        TIPO
                FROM RAW.SQ1_EXT_ZBWFI_REP_ANTSALDET) AS FACT
        
                LEFT JOIN
                
                (SELECT DISTINCT SPART,
                        KUNNR
                FROM RAW.SQ1_EXT_0CUST_SALES_TEXT
                WHERE SPART = '00') AS SECTOR
        
                ON FACT.KUNNR = SECTOR.KUNNR

                LEFT OUTER JOIN

                
                (SELECT DISTINCT KUNNR,
                LAND1,
                FROM RAW.SQ1_EXT_0CUSTOMER_ATTR
                WHERE SPRAS = 'S') AS PAIS

                ON FACT.KUNNR = PAIS.KUNNR
        )
)
WHERE ANIO_MES = '202509'
AND SOCIEDAD_ID = 'A101'
GROUP BY MON_DOC;


SELECT MON_DOC, SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA
FROM CON.FCT_FIN_CARTERAHIST
WHERE ANIO_MES = '202509'
AND SOCIEDAD_ID = 'A101'
GROUP BY MON_DOC;

SELECT MON_DOC, SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA
FROM CON.FCT_FIN_CARTERAACT
WHERE ANIO_MES = '202509'
AND SOCIEDAD_ID = 'A101'
GROUP BY MON_DOC;

SELECT MON_DOC, SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA
FROM CON.FCT_FIN_CARTERAHIST
WHERE ANIO_MES = '202509'
AND SOCIEDAD_ID = 'A101'
GROUP BY MON_DOC;

SELECT MON_DOC, SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA
FROM MIRRORING.VW_FCT_FIN_ADH_CARTERA
WHERE ANIO_MES = '202509'
AND SOCIEDAD_ID = 'A101'
GROUP BY MON_DOC;

SELECT SUM(IND_IMP_CARTERA_TOTAL_MDOC) AS CARTERA
FROM MIRRORING.FCT_FIN_ADH_CARTERA
WHERE ANIO_MES = '202501';



SELECT 
FROM ;