--TRUNCATE TABLE CON.FCT_COM_ADH_VENTAS_ACT;

SELECT COUNT(0) FROM CON.FCT_COM_ADH_VENTAS_ACT;

SELECT * FROM RAW.PARAMETROS_EXTRACCION 
WHERE NEGOCIO = 'ADH_MEXICO' AND EXTRACTOR LIKE '%CUADERNO%'
;

SELECT DISTINCT FECHA_CARGA  FROM PRE.PFCT_COM_VENTAS WHERE SOCIEDAD_ID BETWEEN 'A101' AND 'A104';

SELECT COUNT(0) FROM MIRRORING.FCT_COM_ADH_COMERCIAL WHERE MODELO = 'VENTAS';

SELECT * FROM CON.FCT_COM_ADH_BACKORDER_ACT;

SELECT * FROM MIRRORING.VW_FCT_COM_ADH_BACKORDER_ACT;



SELECT DISTINCT MODELO
 FROM MIRRORING.FCT_COM_ADH_COMERCIAL ;

 CALL CON.SP_CON_FCT_COM_ADH_VENTAS_ACT('ZBWSD_CUADERNO_FINANCIERO','ADH_MEXICO');


 CALL CON.SP_CON_DIM_ORG_UENADHESIVOS();

CALL CON.SP_CON_DIM_ORG_ORGANIZACIONVENTAS();

CALL CON.SP_CON_DIM_ORG_CANALDISTRIBUCION();

CALL CON.SP_CON_DIM_ORG_OFICINAVENTAS();

CALL CON.SP_CON_DIM_ORG_ZONAVENTAS();

CALL CON.SP_CON_DIM_ORG_GRUPOVENDEDORES();

CALL CON.SP_CON_DIM_ORG_SECTOR();

CALL CON.SP_CON_DIM_ORG_SOCIEDAD();

CALL CON.SP_CON_DIM_ORG_CENTRO();


CALL CON.SP_CON_DIM_ORG_ALMACENCENTRO();

CALL CON.SP_CON_DIM_GEO_PAIS();

SELECT * FROM MIRRORING.DIM_GEO_PAIS;


CALL CON.SP_CON_DIM_GEO_REGION();

SELECT * FROM MIRRORING.DIM_GEO_REGION;

CALL CON.SP_CON_DIM_GEO_ZONATRANSPORTE();

SELECT * FROM MIRRORING.DIM_GEO_ZONATRANSPORTE;

CALL CON.SP_CON_DIM_OBR_CONSTRUCTORA();

SELECT * FROM MIRRORING.DIM_OBR_CONSTRUCTORA;

CALL CON.SP_CON_DIM_OBR_PROMOTOR();

SELECT * FROM MIRRORING.DIM_OBR_PROMOTOR;


call CON.SP_CON_DIM_OBR_SEGMENTO_OBRA();

SELECT * FROM MIRRORING.DIM_OBR_SEGMENTO_OBRA;


CALL CON.SP_CON_DIM_OBR_TIPO_OBRA();



CALL  PRE.SP_PRE_PDIM_TRA_TRANSPORTISTA();
SELECT * FROM PRE.PDIM_TRA_TRANSPORTISTA;

SELECT *  FROM RAW.SQ1_EXT_0VENDOR_ATTR;


CALL CON.SP_CON_DIM_TRA_TRANSPORTISTA();

SELECT * FROM MIRRORING.DIM_TRA_TRANSPORTISTA;


CALL CON.SP_CON_DIM_TRA_RUTA();

SELECT * FROM MIRRORING.DIM_TRA_RUTA;


CALL CON.SP_CON_DIM_TRA_PUESTOPLANTRANSP();
SELECT * FROM MIRRORING.DIM_TRA_PUESTOPLANTRANSP;


CALL CON.SP_CON_DIM_TRA_CLASETRANSPORTE();

SELECT * FROM MIRRORING.DIM_TRA_CLASETRANSPORTE;


CALL CON.SP_CON_DIM_TRA_CLASEEXPEDICION();

SELECT * FROM MIRRORING.DIM_TRA_CLASEEXPEDICION;

SELECT * FROM CON.DIM_TRA_TIPOTRANSPORTE;

SELECT DISTINCT UNI_UMB FROM CON.DIM_MAT_MATERIAL;


call CON.SP_CON_DIM_MAT_MATERIAL();
SELECT * FROM MIRRORING.DIM_MAT_MATERIAL_ADH;

SELECT * FROM LOGS.HISTORIAL_EJECUCIONES ORDER BY FECHA_HORA_INICIO DESC;


CALL CON.SP_CON_DIM_MAT_MATERIALCENTRO();

SELECT * FROM MIRRORING.DIM_MAT_MATERIALCENTRO;
SELECT * FROM MIRRORING.DIM_MAT_MATERIALCENTRO_ADH;


CALL PRE.SP_PRE_PDIM_MAT_MATERIALVENTAS();


CALL CON.SP_CON_DIM_MAT_MATERIALVENTAS();


call CON.SP_CON_DIM_DOC_CONDICIONEXP();

CALL CON.SP_CON_DIM_DOC_INCOTERMS();

CALL CON.SP_CON_DIM_CLI_ASESORCOMERCIAL();

CALL CON.SP_CON_DIM_DOC_MOTIVOPEDIDO();

CALL CON.SP_CON_DIM_DOC_TIPOPOSICION();


CALL PRE.SP_PRE_PDIM_CLI_CLIENTE();



SELECT * FROM MIRRORING.DIM_CLI_CLIENTE;

CALL CON.SP_CON_DIM_CLI_DESTINATARIO();


SELECT * FROM MIRRORING.DIM_CLI_DESTINATARIO;

CALL CON.SP_CON_DIM_CLI_EJECUTIVOCIS();

SELECT * FROM MIRRORING.DIM_CLI_EJECUTIVOCIS;


CALL CON.SP_CON_DIM_CLI_ASESORCOMERCIAL();


SELECT * FROM MIRRORING.DIM_CLI_ASESORCOMERCIAL;
SELECT * FROM MIRRORING.DIM_CLI_ASESORPEDIDO;
SELECT * FROM MIRRORING.DIM_CLI_ASESORFACTURA;

SELECT * FROM MIRRORING.DIM_CLI_TIENDARECIBO;

CALL CON.SP_CON_DIM_CLI_TIENDARECIBO();



CALL CON.SP_CON_DIM_CLI_SOLICITANTE();

SELECT * FROM MIRRORING.DIM_CLI_SOLICITANTE;

CALL CON.SP_CON_DIM_DOC_TIPOPOSICION();

SELECT * FROM MIRRORING.DIM_DOC_TIPOPOSICION;


CALL CON.SP_CON_DIM_DOC_STATUSCREDITO();

SELECT * FROM MIRRORING.DIM_DOC_STATUSCREDITO;

CALL CON.SP_CON_DIM_DOC_RANGOANTPED();

SELECT * FROM MIRRORING.DIM_DOC_RANGOANTPED;


CALL CON.SP_CON_DIM_DOC_MOTIVORECHAZO();

SELECT * FROM MIRRORING.DIM_DOC_MOTIVORECHAZO;

CALL CON.SP_CON_DIM_DOC_MOTIVOPEDIDO();

SELECT * FROM MIRRORING.DIM_DOC_MOTIVOPEDIDO;

CALL CON.SP_CON_DIM_DOC_INCOTERMS();

SELECT * FROM MIRRORING.DIM_DOC_INCOTERMS;

CALL CON.SP_CON_DIM_DOC_CONDICIONEXP();
SELECT * FROM  MIRRORING.DIM_DOC_CONDICIONEXP;

CALL CON.SP_CON_DIM_DOC_CLASEPEDIDO();
SELECT * FROM MIRRORING.DIM_DOC_CLASEPEDIDO;

CALL CON.SP_CON_DIM_DOC_CLASEFACTURA();

SELECT 
* FROM MIRRORING.DIM_DOC_CLASEFACTURA;

CALL CON.SP_CON_DIM_DOC_BLOQUEOENTREGA();

SELECT * FROM MIRRORING.DIM_DOC_BLOQUEOENTREGA;

CALL CON.SP_CON_DIM_DOC_BLOQUEOENTREGA_POS();

SELECT * FROM MIRRORING.DIM_DOC_BLOQUEOENTREGA_POS;


SELECT * FROM CON.FCT_COM_ADH_VENTAS_ACT;

SELECT * FROM CON.FCT_COM_ADH_VENTAS_HIST;

SELECT * FROM MIRRORING.FCT_COM_ADH_COMERCIAL;
SELECT * FROM MIRRORING.TR_FCT_COM_ADH_VENTAS_ACT;
SELECT * FROM MIRRORING.STREAM_FCT_COM_ADH_VENTAS_ACT;

CALL CON.SP_CON_FCT_COM_ADH_VENTAS_ACT('ZBWSD_CUADERNO_FINANCIERO','ADH_MEXICO');
CALL CON.SP_CON_FCT_COM_ADH_VENTAS_PCP;

SELECT * FROM RAW.PARAMETROS_EXTRACCION WHERE EXTRACTOR = 'ZBWSD_CUADERNO_FINANCIERO' AND NEGOCIO = 'ADH_MEXICO';
UPDATE RAW.PARAMETROS_EXTRACCION
SET R_INICIO = '20250101' , R_FIN = '20250630'
WHERE 
PARAMETRO = 'FKDAT' AND
EXTRACTOR = 'ZBWSD_CUADERNO_FINANCIERO' AND NEGOCIO = 'ADH_MEXICO';

SELECT CONCAT(COLUMN_NAME,',') COLUMNA FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME= 'VW_FCT_COM_ADH_PEDIDOS_ACT' ORDER BY ORDINAL_POSITION;


CALL CON.SP_CON_DIM_CLI_CLIENTE();

SELECT COUNT(CLIENTE_ID) CONTEO, CLIENTE_ID
 FROM CON.DIM_CLI_CLIENTE
 GROUP BY
 CLIENTE_ID
 HAVING COUNT(CLIENTE_ID)>1
 ;

 SELECT COUNT(CLIENTE_ID) CONTEO, CLIENTE_ID
 FROM MIRRORING.DIM_CLI_CLIENTE
 GROUP BY
 CLIENTE_ID
 HAVING COUNT(CLIENTE_ID)>1
 ;


 CALL CON.SP_CON_DIM_ORG_ALMACENCENTRO();

 SELECT * FROM MIRRORING.DIM_ORG_ALMACENCENTRO;