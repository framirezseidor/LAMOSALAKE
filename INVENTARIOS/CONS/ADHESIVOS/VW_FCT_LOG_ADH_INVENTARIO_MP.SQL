USE DATABASE LAMOSALAKE_DEV;
USE SCHEMA CON;

CREATE OR REPLACE VIEW  VW_FCT_LOG_ADH_INVENTARIO_MP AS

SELECT
ANIO,
MES,
ANIOMES,
FECHA_FOTO_INVENTARIO,
CENTRO_ID,
ALMACEN_ID,
ALMACENCENTRO_ID,
MATERIAL_ID,
MATERIALCENTRO_ID,
TIPOMATERIAL_ID,
CONTROL_PRECIOS,
STOCKESPECIAL,
NUMSTOCKESPECIAL,
LOTE,
LOTECENTRO_ID,
IND_LIBRE_UTILIZACION_UMB,
IND_BLOQUEADO_UMB,
IND_CONTROL_CALIDAD_UMB,
IND_TRANSITO_UMB,
IND_INVENTARIO_FISICO_UMB,
IND_STOCK_SEGURIDAD_UMB,
UNI_UMB,
IND_COSTO_INV_MXN,
MON_MXN,
IND_COSTO_INV_LOC,
MON_LOC,
IND_COSTO_INV_USD,
MON_USD,
ID_SISORIGEN,
MANDANTE,
FECHA_CARGA,
ZONA_HORARIA

FROM FCT_LOG_ADH_INVENTARIO_ACT WHERE TIPOMATERIAL_ID NOT IN ('FERT', 'ZHAW')

UNION

SELECT
ANIO,
MES,
ANIOMES,
FECHA_FOTO_INVENTARIO,
CENTRO_ID,
ALMACEN_ID,
ALMACENCENTRO_ID,
MATERIAL_ID,
MATERIALCENTRO_ID,
TIPOMATERIAL_ID,
CONTROL_PRECIOS,
STOCKESPECIAL,
NUMSTOCKESPECIAL,
LOTE,
LOTECENTRO_ID,
IND_LIBRE_UTILIZACION_UMB,
IND_BLOQUEADO_UMB,
IND_CONTROL_CALIDAD_UMB,
IND_TRANSITO_UMB,
IND_INVENTARIO_FISICO_UMB,
IND_STOCK_SEGURIDAD_UMB,
UNI_UMB,
IND_COSTO_INV_MXN,
MON_MXN,
IND_COSTO_INV_LOC,
MON_LOC,
IND_COSTO_INV_USD,
MON_USD,
'',
'',
'',
''

FROM FCT_LOG_ADH_INVENTARIO_FOTO WHERE TIPOMATERIAL_ID NOT IN ('FERT', 'ZHAW')