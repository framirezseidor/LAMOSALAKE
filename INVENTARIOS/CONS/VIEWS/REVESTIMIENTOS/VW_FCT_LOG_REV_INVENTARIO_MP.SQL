CREATE OR alter VIEW  CON.VW_FCT_LOG_REV_INVENTARIO_MP AS

SELECT
ANIO,
MES,
ANIOMES,
FECHA_FOTO_INVENTARIO,
CENTRO_ID,
ALMACEN_ID,
ALMACENCENTRO_ID,
MATERIAL_ID,
MATERIALCENTRO_ID,
TIPOMATERIAL_ID,
CONTROL_PRECIOS,
STOCKESPECIAL,
NUMSTOCKESPECIAL,
LOTE,
LOTECENTRO_ID,
IND_LIBRE_UTILIZACION_UMB,
IND_BLOQUEADO_UMB,
IND_CONTROL_CALIDAD_UMB,
IND_TRANSITO_UMB,
IND_INVENTARIO_FISICO_UMB,
IND_STOCK_SEGURIDAD_UMB,
UNI_UMB,
IND_COSTO_INV_MXN,
MON_MXN,
IND_COSTO_INV_LOC,
MON_LOC,
IND_COSTO_INV_USD,
MON_USD,
SISORIGEN_ID,
MANDANTE,
FECHA_CARGA,
ZONA_HORARIA

FROM CON.FCT_LOG_REV_INVENTARIO_ACT WHERE 1 = 1

AND TIPOMATERIAL_ID NOT IN ('FERT', 'ZHAW')
AND CENTRO_ID IN (SELECT CENTRO_ID FROM CON.VW_DIM_ORG_CENTRO)

UNION ALL

SELECT
ANIO,
MES,
ANIOMES,
FECHA_FOTO_INVENTARIO,
CENTRO_ID,
ALMACEN_ID,
ALMACENCENTRO_ID,
MATERIAL_ID,
MATERIALCENTRO_ID,
TIPOMATERIAL_ID,
CONTROL_PRECIOS,
STOCKESPECIAL,
NUMSTOCKESPECIAL,
LOTE,
LOTECENTRO_ID,
IND_LIBRE_UTILIZACION_UMB,
IND_BLOQUEADO_UMB,
IND_CONTROL_CALIDAD_UMB,
IND_TRANSITO_UMB,
IND_INVENTARIO_FISICO_UMB,
IND_STOCK_SEGURIDAD_UMB,
UNI_UMB,
IND_COSTO_INV_MXN,
MON_MXN,
IND_COSTO_INV_LOC,
MON_LOC,
IND_COSTO_INV_USD,
MON_USD,
'',
'',
null,
''

FROM CON.FCT_LOG_REV_INVENTARIO_FOTO WHERE 1 = 1

AND TIPOMATERIAL_ID NOT IN ('FERT', 'ZHAW') 
AND CENTRO_ID IN (SELECT CENTRO_ID FROM CON.VW_DIM_ORG_CENTRO)