CREATE OR REPLACE VIEW CON.VW_DIM_MAT_MATERIAL_REV AS
SELECT
    M.MATERIAL_ID, 
    M.MATERIAL_TEXT,
    M.TIPOMATERIAL_ID,
    TM.TIPOMATERIAL_TEXT, 
    M.GRUPOARTICULOS_ID,
    GRUPO_MAT.GRUPOMATERIALES_TEXT AS GRUPOARTICULOS_TEXT,-- NO EXISTE GRUPOARTICULOS_TEXT, SE ESTA USANDO GRUPOMATERIALES_TEXT EN LUGAR DE GRUPOARTICULOS_TEXT
    M.STATUSMAT_TODOSCENTROS_ID,
    STATUS_MAT.STATUSMATERIAL_TEXT AS STATUSMAT_TODOSCENTROS_TEXT, -- NO EXISTE STATUSMAT_TODOSCENTROS_TEXT, E ESTA USANDO STATUSMATERIAL_TEXT EN LUGAR DE STATUSMAT_TODOSCENTROS_TEXT
    M.ACABADO_ID,
    ACABADO_REV.ACABADO_TEXT,
    M.APLICACION_ID,
    MAT_APLICACION_REV.APLICACION_TEXT,
    M.DISENODETALLE_ID,
    DISENO_DETALLE_REV.DISENODETALLE_TEXT,
    M.CALIDAD_ID,
    CALIDAD_REV.CALIDAD_TEXT,
    M.COLOR_REV_ID,
    COLOR_REV.COLOR_REV_TEXT,
    M.COLORGRUPO_REV_ID,
    COLORGRUPO_REV.COLORGRUPO_REV_TEXT,
    M.CUERPO_ID,
    CUERPO_REV.CUERPO_TEXT,
    M.CUERPODET_ID,
    CUERPO_DETALLE_REV.CUERPODET_TEXT,
    M.DISENO_ID,
    DISENO_REV.DISENO_TEXT,
    M.FAMILIA_REV_ID,
    FAMILIA_REV.FAMILIA_REV_TEXT,
    M.FAMILIAGRUPO_ID,
    FAMILIAGRUPO_REV.FAMILIAGRUPO_TEXT,
    M.FORMATO_ID,
    FORMATO_REV.FORMATO_TEXT,
    M.FORMATOGRUPO_ID,
    FORMATOGRUPO_REV.FORMATOGRUPO_TEXT,
    M.FORMATORANGO_ID,
    FORMATORANGO_REV.FORMATORANGO_TEXT,
    M.FORMATOTAMANO_ID,
    FORMATOTAMANO_REV.FORMATOTAMANO_TEXT,
    M.LANZAMIENTOS_ID,
    LANZAMIENTOS_REV.LANZAMIENTOS_TEXT,
    M.LINEAMATERIAL_ID,
    LINEAMATERIAL_REV.LINEAMATERIAL_TEXT,
    M.MARCA_REV_ID,
    MARCA_REV.MARCA_REV_TEXT,
    M.MARCAGRUPO_REV_ID,
    MARCAGRUPO_REV.MARCAGRUPO_REV_TEXT,
    M.MARCAPLANEACION_ID,
    MARCAPLANEACION_REV.MARCAPLANEACION_TEXT,
    M.SEGMENTO_REV_ID,
    SEGMENTO_REV.SEGMENTO_REV_TEXT,
    M.PEIDESTONALIZACION_ID,
    PEIDESTONALIZACION_REV.PEIDESTONALIZACION_TEXT,
    M.ORIGENMATERIAL_REV_ID,
    ORIGENMATERIAL_REV.ORIGENMATERIAL_REV_TEXT,
    M.ORIGENPAIS_REV_ID,
    ORIGENPAIS_REV.ORIGENPAIS_REV_TEXT,
    M.ORIGENPROVEEDOR_ID,
    ORIGENPROVEEDOR_REV.ORIGENPROVEEDOR_TEXT,
    M.PROCESOADICIONAL_ID,
    PROCESOADICIONAL_REV.PROCESOADICIONAL_TEXT,
    M.PUNZON_ID,
    PUNZON_REV.PUNZON_TEXT,
    M.PUNZONDETALLE_ID,
    PUNZONDETALLE_REV.PUNZONDETALLE_TEXT,
    M.RECTIFICADO_ID,
    RECTIFICADO_REV.RECTIFICADO_TEXT,
    M.RESERVADO_ID,
    RESERVADO_REV.RESERVADO_TEXT,
    M.SUBMARCA_ID,
    SUBMARCA_REV.SUBMARCA_TEXT,
    M.TECNOLOGIA_ID,
    TECNOLOGIA_REV.TECNOLOGIA_TEXT,
    M.TECNOLOGIAGRUPO_ID,
    TECNOLOGIAGRUPO_REV.TECNOLOGIAGRUPO_TEXT,
    M.ESPESOR_ID,
    ESPESOR_REV.ESPESOR_TEXT,
    M.ESTATUSCATALOGO_ID,
    ESTATUSCATALOGO_REV.ESTATUSCATALOGO_TEXT,
    M.PADRE_ID,
    PADRE_REV.PADRE_TEXT,
    M.SISORIGEN_ID,
    M.FECHA_CARGA,
    M.ZONA_HORARIA,
    M.MANDANTE
FROM  CON.DIM_MAT_MATERIAL AS  M
LEFT JOIN CON.DIM_MAT_TIPOMATERIAL AS TM
    ON M.TIPOMATERIAL_ID = TM.TIPOMATERIAL_ID
LEFT JOIN CON.DIM_MAT_GRUPOMATERIALES AS GRUPO_MAT 
    ON M.GRUPOARTICULOS_ID = GRUPO_MAT.GRUPOMATERIALES_ID -- NO EXISTE GRUPOARTICULOS_ID EN DIM_MAT_GRUPOMATERIALES, Se esta usando GRUPOMATERIALES_ID en lugar de GRUPOARTICULOS_ID
LEFT JOIN CON.DIM_MAT_STATUSMATERIAL AS STATUS_MAT
    ON M.STATUSMAT_TODOSCENTROS_ID = STATUS_MAT.STATUSMATERIAL_ID
LEFT JOIN CON.DIM_MAT_ACABADO_REV AS ACABADO_REV 
    ON M.ACABADO_ID =  ACABADO_REV.ACABADO_ID 
LEFT JOIN CON.DIM_MAT_APLICACION_REV AS MAT_APLICACION_REV
    ON M.APLICACION_ID =  MAT_APLICACION_REV.APLICACION_ID
LEFT JOIN CON.DIM_MAT_DISENODETALLE_REV AS DISENO_DETALLE_REV 
    ON M.DISENODETALLE_ID = DISENO_DETALLE_REV.DISENODETALLE_ID 
LEFT JOIN CON.DIM_MAT_CALIDAD_REV AS CALIDAD_REV
    ON M.CALIDAD_ID = CALIDAD_REV.CALIDAD_ID
LEFT JOIN CON.DIM_MAT_COLOR_REV AS COLOR_REV 
    ON M.COLOR_REV_ID = COLOR_REV.COLOR_REV_ID
LEFT JOIN CON.DIM_MAT_COLORGRUPO_REV AS COLORGRUPO_REV 
    ON M.COLORGRUPO_REV_ID = COLORGRUPO_REV.COLORGRUPO_REV_ID
LEFT JOIN CON.DIM_MAT_CUERPO_REV AS CUERPO_REV 
    ON M.CUERPO_ID = CUERPO_REV.CUERPO_ID
LEFT JOIN CON.DIM_MAT_CUERPODETALLE_REV AS CUERPO_DETALLE_REV -- NO EXISTE DIM_MAT_CUERPODETALLE SE ESTA USANDO DIM_MAT_CUERPODETALLE_REV
    ON M.CUERPODET_ID = CUERPO_DETALLE_REV.CUERPODET_ID
LEFT JOIN CON.DIM_MAT_DISENO_REV AS DISENO_REV
    ON M.DISENO_ID = DISENO_REV.DISENO_ID
LEFT JOIN CON.DIM_MAT_FAMILIA_REV AS FAMILIA_REV 
    ON M.FAMILIA_REV_ID = FAMILIA_REV.FAMILIA_REV_ID
LEFT JOIN CON.DIM_MAT_FAMILIAGRUPO_REV AS FAMILIAGRUPO_REV 
    ON M.FAMILIAGRUPO_ID = FAMILIAGRUPO_REV.FAMILIAGRUPO_ID
LEFT JOIN CON.DIM_MAT_FORMATO_REV AS FORMATO_REV 
    ON M.FORMATO_ID = FORMATO_REV.FORMATO_ID
LEFT JOIN CON.DIM_MAT_FORMATOGRUPO_REV AS FORMATOGRUPO_REV 
    ON M.FORMATOGRUPO_ID = FORMATOGRUPO_REV.FORMATOGRUPO_ID
LEFT JOIN CON.DIM_MAT_FORMATORANGO_REV AS FORMATORANGO_REV 
    ON M.FORMATORANGO_ID = FORMATORANGO_REV.FORMATORANGO_ID
LEFT JOIN CON.DIM_MAT_FORMATOTAMANO_REV AS FORMATOTAMANO_REV 
    ON M.FORMATOTAMANO_ID = FORMATOTAMANO_REV.FORMATOTAMANO_ID
LEFT JOIN CON.DIM_MAT_LANZAMIENTOS_REV AS LANZAMIENTOS_REV 
    ON M.LANZAMIENTOS_ID = LANZAMIENTOS_REV.LANZAMIENTOS_ID
LEFT JOIN CON.DIM_MAT_LINEAMATERIAL_REV AS LINEAMATERIAL_REV 
    ON M.LINEAMATERIAL_ID = LINEAMATERIAL_REV.LINEAMATERIAL_ID
LEFT JOIN CON.DIM_MAT_MARCA_REV AS MARCA_REV
    ON M.MARCA_REV_ID = MARCA_REV.MARCA_REV_ID
LEFT JOIN CON.DIM_MAT_MARCAGRUPO_REV AS MARCAGRUPO_REV
    ON M.MARCAGRUPO_REV_ID = MARCAGRUPO_REV.MARCAGRUPO_REV_ID
LEFT JOIN CON.DIM_MAT_MARCAPLANEACION_REV AS MARCAPLANEACION_REV  
    ON M.MARCAPLANEACION_ID = MARCAPLANEACION_REV.MARCAPLANEACION_ID
LEFT JOIN CON.DIM_MAT_SEGMENTO_REV AS SEGMENTO_REV  
    ON M.SEGMENTO_REV_ID = SEGMENTO_REV.SEGMENTO_REV_ID
LEFT JOIN CON.DIM_MAT_PEIDESTONALIZACION_REV AS PEIDESTONALIZACION_REV
    ON M.PEIDESTONALIZACION_ID = PEIDESTONALIZACION_REV.PEIDESTONALIZACION_ID
LEFT JOIN CON.DIM_MAT_ORIGENMATERIAL_REV AS ORIGENMATERIAL_REV 
    ON M.ORIGENMATERIAL_REV_ID = ORIGENMATERIAL_REV.ORIGENMATERIAL_REV_ID
LEFT JOIN CON.DIM_MAT_ORIGENPAIS_REV AS ORIGENPAIS_REV 
    ON M.ORIGENPAIS_REV_ID = ORIGENPAIS_REV.ORIGENPAIS_REV_ID
LEFT JOIN CON.DIM_MAT_ORIGENPROVEEDOR_REV AS ORIGENPROVEEDOR_REV 
    ON M.ORIGENPROVEEDOR_ID = ORIGENPROVEEDOR_REV.ORIGENPROVEEDOR_ID
LEFT JOIN CON.DIM_MAT_PROCESOADICIONAL_REV AS PROCESOADICIONAL_REV 
    ON M.PROCESOADICIONAL_ID = PROCESOADICIONAL_REV.PROCESOADICIONAL_ID
LEFT JOIN CON.DIM_MAT_PUNZON_REV AS PUNZON_REV 
    ON M.PUNZON_ID = PUNZON_REV.PUNZON_ID
LEFT JOIN CON.DIM_MAT_PUNZONDETALLE_REV AS PUNZONDETALLE_REV 
    ON M.PUNZONDETALLE_ID = PUNZONDETALLE_REV.PUNZONDETALLE_ID
LEFT JOIN CON.DIM_MAT_RECTIFICADO_REV AS RECTIFICADO_REV  
    ON M.RECTIFICADO_ID = RECTIFICADO_REV.RECTIFICADO_ID
LEFT JOIN CON.DIM_MAT_RESERVADO_REV AS RESERVADO_REV
    ON M.RESERVADO_ID = RESERVADO_REV.RESERVADO_ID
LEFT JOIN CON.DIM_MAT_SUBMARCA_REV AS SUBMARCA_REV 
    ON M.SUBMARCA_ID = SUBMARCA_REV.SUBMARCA_ID
LEFT JOIN CON.DIM_MAT_TECNOLOGIA_REV AS TECNOLOGIA_REV 
    ON M.TECNOLOGIA_ID = TECNOLOGIA_REV.TECNOLOGIA_ID
LEFT JOIN CON.DIM_MAT_TECNOLOGIAGRUPO_REV AS TECNOLOGIAGRUPO_REV 
    ON M.TECNOLOGIAGRUPO_ID = TECNOLOGIAGRUPO_REV.TECNOLOGIAGRUPO_ID
LEFT JOIN CON.DIM_MAT_ESPESOR_REV AS ESPESOR_REV 
    ON M.ESPESOR_ID = ESPESOR_REV.ESPESOR_ID
LEFT JOIN CON.DIM_MAT_ESTATUSCATALOGO_REV AS ESTATUSCATALOGO_REV 
    ON M.ESTATUSCATALOGO_ID = ESTATUSCATALOGO_REV.ESTATUSCATALOGO_ID
LEFT JOIN CON.DIM_MAT_PADRE_REV AS PADRE_REV
    ON M.PADRE_ID = PADRE_REV.PADRE_ID
